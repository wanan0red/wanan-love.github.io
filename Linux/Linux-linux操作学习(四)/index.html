<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Linux学习(四) | wanan</title><meta name="keywords" content="Linux"><meta name="author" content="wanan"><meta name="copyright" content="wanan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Linux学习(四)用户身份与文件权限用户身份与能力linux系统中的管理员就是root,这是错误的,linux系统的管理员之所以是root,并非是他的名字叫root,而是因为该用户的身份号码即(UID)user identification 的数值为0 ,在linux系统中,UID就像我们的身份号码一样,具有唯一性,因此可以通过用户的UID来判断用户的身份.  管理员UID为0:系统的管理员用户">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux学习(四)">
<meta property="og:url" content="https://www.wanan.red/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/index.html">
<meta property="og:site_name" content="wanan">
<meta property="og:description" content="Linux学习(四)用户身份与文件权限用户身份与能力linux系统中的管理员就是root,这是错误的,linux系统的管理员之所以是root,并非是他的名字叫root,而是因为该用户的身份号码即(UID)user identification 的数值为0 ,在linux系统中,UID就像我们的身份号码一样,具有唯一性,因此可以通过用户的UID来判断用户的身份.  管理员UID为0:系统的管理员用户">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_1280.jpg">
<meta property="article:published_time" content="2022-03-24T05:11:52.508Z">
<meta property="article:modified_time" content="2022-08-30T06:45:30.200Z">
<meta property="article:author" content="wanan">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_1280.jpg"><link rel="shortcut icon" href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203092159138.jpeg"><link rel="canonical" href="https://www.wanan.red/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Lkrie_55AalLqll4AtBs-NEomlv8QQYHGMx1V0cbq88"/><meta name="baidu-site-verification" content="code-e6YD56vlMd"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux学习(四)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-30 14:45:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203092159138.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">71</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">54</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_1280.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">wanan</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux学习(四)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-24T05:11:52.508Z" title="发表于 2022-03-24 13:11:52">2022-03-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-30T06:45:30.200Z" title="更新于 2022-08-30 14:45:30">2022-08-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/Linux%E5%AD%A6%E4%B9%A0-%E5%9B%9B/">Linux学习(四)</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux学习(四)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Linux学习-四"><a href="#Linux学习-四" class="headerlink" title="Linux学习(四)"></a>Linux学习(四)</h1><h2 id="用户身份与文件权限"><a href="#用户身份与文件权限" class="headerlink" title="用户身份与文件权限"></a>用户身份与文件权限</h2><h3 id="用户身份与能力"><a href="#用户身份与能力" class="headerlink" title="用户身份与能力"></a>用户身份与能力</h3><p>linux系统中的管理员就是root,这是错误的,linux系统的管理员之所以是root,并非是他的名字叫root,而是因为该用户的身份号码即(UID)user identification 的数值为0 ,在linux系统中,UID就像我们的身份号码一样,具有唯一性,因此可以通过用户的UID来判断用户的身份.</p>
<ul>
<li>管理员UID为0:系统的管理员用户</li>
<li>系统用户UID为1~999:linux系统为了避免某个因服务程序出现漏洞而被黑客提权至整台服务器,默认服务程序会由独立的系统用户负责运行,进而有效控制被破坏的范围</li>
<li>普通用户UID从1000开始:是由管理员创建的用于日常工作的用户</li>
</ul>
<p>需要注意的是,UID是不能冲突的,而且管理员创建的普通用户的uid默认是从1000开始的(即使前面还有闲置的号码)</p>
<p>为了方便管理属于同一组的用户,linux引入了组的概念,通过使用用户组号码(GID Group IDentIfication)可以把多个用户添加到同一组中,从而方便为组中的用户同一划定权限或者指定任务.假设一个公司中有多个部门,每个部门中又有很多员工,如果只是想让员工访问本部门内的资源,则可以针对部门而非具体的员工来设置权限.</p>
<p>另外,在linux系统中创建每个用户时,将自动创建一个与其同名的基本用户组,而且这个基本用户组只有用户一个人,如果该用户以后被归纳到其他用户组,则这个其他用户组成为扩展用户组,一个用户只有一个基本用户组,但是可以有多个扩展用户组,从而满足日常的工作需要</p>
<p>基本用户组就像是原生家庭,实在创建账号时就自动生成的,而扩展用户组则像工作单位为了完成任务,需要加入到各个不同的群体中,这是需要手动添加的</p>
<h4 id="id命令"><a href="#id命令" class="headerlink" title="id命令"></a>id命令</h4><p>id命令用于显示用户的详细信息,语法格式为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id 用户名</span><br></pre></td></tr></table></figure>

<p>这个id命令时一个在创建用户前需要学习的命令,它能够简单轻松的查看用户的基本信息,例如用户id 基本组 与扩展组gid以便于我们判别某个用户是否已经存在,以及查看相关信息</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231430633.png" alt="image-20220323143017596"></p>
<h4 id="useradd命令"><a href="#useradd命令" class="headerlink" title="useradd命令"></a>useradd命令</h4><p>useradd命令用于创建新的用户账号,语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useradd [参数] 用户名</span><br></pre></td></tr></table></figure>

<p>可以使用useradd命令用于创建用户账户.使用该命令创建用户时,默认的用户家目录会被存放在&#x2F;home目录中,默认的shell解释器为&#x2F;bin&#x2F;bash,而且默认会创建一个与该用户同名的基本用户组.</p>
<p>useradd命令中的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>指定用户的家目录（默认为&#x2F;home&#x2F;username）</td>
</tr>
<tr>
<td>-e</td>
<td>账户的到期时间，格式为YYYY-MM-DD.</td>
</tr>
<tr>
<td>-u</td>
<td>指定该用户的默认UID</td>
</tr>
<tr>
<td>-g</td>
<td>指定一个初始的用户基本组（必须已存在）</td>
</tr>
<tr>
<td>-G</td>
<td>指定一个或多个扩展用户组</td>
</tr>
<tr>
<td>-N</td>
<td>不创建与用户同名的基本用户组</td>
</tr>
<tr>
<td>-s</td>
<td>指定该用户的默认Shell解释器</td>
</tr>
</tbody></table>
<p>下面使用useradd命令创建一个名称为wanan的用户,并使用id命令确认信息</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231434891.png" alt="image-20220323143447848"></p>
<p>创建一个普通用户并指定家目录的路径,用户的UID以及shell解释器,在下面的命令中,请注意&#x2F;sbin&#x2F;nologin,他是终端解释器中的一员,与bash解释器有着天壤之别,一旦用户的解释器被设置为nologin,代表用户不能登录到系统中</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231437328.png" alt="image-20220323143744291"></p>
<h4 id="groupadd命令"><a href="#groupadd命令" class="headerlink" title="groupadd命令"></a>groupadd命令</h4><p>groupadd命令用于创建新的用户组语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">groupadd [参数] 群组名</span><br></pre></td></tr></table></figure>

<p>为了能够更加高效的指派系统中各个用户的权限,在工作中常常会把这几个用户加入到同一个用户组中,这样便可以针对一类用户同一安排权限.例如在工作中成立了一个部门组,当有新同事加入是就把他的账号添加到这个部门组中,这样新同事的权限就会自动跟其他同事一模一样了,从而省去了一系列繁琐的操作</p>
<p>创建用户组的步骤非常简单,例如使用如下命令创建一个用户组user</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231443149.png" alt="image-20220323144311110"></p>
<h4 id="usermod命令"><a href="#usermod命令" class="headerlink" title="usermod命令"></a>usermod命令</h4><p>usermod命令用于修改用户的属性,英文为 user modify 语法格式为 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">usermod [参数] 用户名</span><br></pre></td></tr></table></figure>

<p>在系统中创建用户也就是修改配置文件的过程,用户的信息保存在&#x2F;etc&#x2F;passwd文件中,可以直接使用文本编辑器来修改其中的用户参数项目,也可以使用usermod命令修改已经创建的用户信息,比如用户的UID 基本&#x2F;扩展用户组 默认终端 </p>
<p> usermod命令中的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>填写用户账户的备注信息</td>
</tr>
<tr>
<td>-d -m</td>
<td>参数-m与参数-d连用，可重新指定用户的家目录并自动把旧的数据转移过去</td>
</tr>
<tr>
<td>-e</td>
<td>账户的到期时间，格式为YYYY-MM-DD</td>
</tr>
<tr>
<td>-g</td>
<td>变更所属用户组</td>
</tr>
<tr>
<td>-G</td>
<td>变更扩展用户组</td>
</tr>
<tr>
<td>-L</td>
<td>锁定用户禁止其登录系统</td>
</tr>
<tr>
<td>-U</td>
<td>解锁用户，允许其登录系统</td>
</tr>
<tr>
<td>-s</td>
<td>变更默认终端</td>
</tr>
<tr>
<td>-u</td>
<td>修改用户的UID</td>
</tr>
</tbody></table>
<p>将wanan用-G参数添加到root组中</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231447012.png" alt="image-20220323144737970"></p>
<p>使用-u参数改变wanan用户的UID号码值</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231448838.png" alt="image-20220323144831803"></p>
<p>将默认的&#x2F;bin&#x2F;bash修改为&#x2F;sbin&#x2F;nologin</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231450511.png" alt="image-20220323145057472"></p>
<p>这个用户的终端设置为&#x2F;sbin&#x2F;nologin后用户就不能登录了,但这个用户依然可以被某个服务所调用,管理某个具体的服务,这样的好处是当黑客通过这个服务侵入之后,破坏的范围也仅仅局限于这个特定的服务,而不能使用这个用户身份登录到整台服务器上.</p>
<h4 id="passwd命令"><a href="#passwd命令" class="headerlink" title="passwd命令"></a>passwd命令</h4><p>passwd命令用于修改用户的密码 过期时间等信息 password 语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">passwd [参数] 用户名</span><br></pre></td></tr></table></figure>

<p>普通用户只能使用passwd命令修改自己的系统密码,而root管理员则有权限修改其他所有人的密码,root管理员在linux系统中修改自己或他人的密码时不需要验证旧密码,这一点非常方便</p>
<p> passwd命令中的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>锁定用户，禁止其登录</td>
</tr>
<tr>
<td>-u</td>
<td>解除锁定，允许用户登录</td>
</tr>
<tr>
<td>–stdin</td>
<td>允许通过标准输入修改用户密码，如echo “NewPassWord” | passwd –stdin Username</td>
</tr>
<tr>
<td>-d</td>
<td>使该用户可用空密码登录系统</td>
</tr>
<tr>
<td>-e</td>
<td>强制用户在下次登录时修改密码</td>
</tr>
<tr>
<td>-S</td>
<td>显示用户的密码是否被锁定，以及密码所采用的加密算法名称</td>
</tr>
</tbody></table>
<p>修改自己的密码</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231457840.png" alt="image-20220323145759795"></p>
<p>要修改其他人的密码,则需要先检查当前是否为root管理员权限,然后再命令后指定要修改的用户名称</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231500890.png" alt="image-20220323150015848"></p>
<p>可以使用passwd命令禁止用户登录系统,或者允许登录系统</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231501153.png" alt="image-20220323150158112"></p>
<h4 id="userdel命令"><a href="#userdel命令" class="headerlink" title="userdel命令"></a>userdel命令</h4><p>userdel命令用于删除已有的用户账户 user delete 语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">userdel [参数] 用户名</span><br></pre></td></tr></table></figure>

<p>如果确认某位用户后续不会在登录到系统中,则可以使用userdel命令删除该用户的所有信息,在执行删除操作时,该用户的家目录默认会保留下来,此时可以使用-r参数将其删除</p>
<p>userdel命令中的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-f</td>
<td>强制删除用户</td>
</tr>
<tr>
<td>-r</td>
<td>同时删除用户及用户家目录</td>
</tr>
</tbody></table>
<p>在删除一个用户时,一般会建议保留他的家目录数据,以免有重要的数据被误删,所以在使用userdel命令时可以不加参数,写清楚要删除的用户名称就行</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231507233.png" alt="image-20220323150744188"></p>
<p>虽然此时该用户已经被删除,但家目录数据会继续存放在&#x2F;home目录中,等确认删除时手动将其删除就好</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231510920.png" alt="image-20220323151038881"></p>
<h3 id="文件权限与归属"><a href="#文件权限与归属" class="headerlink" title="文件权限与归属"></a>文件权限与归属</h3><p>在linux系统中,每一个文件都有归属的所有者和所属组,并规定了文件的所有者 所属组以及其他人对文件所拥有的可读(r) 可写(w) 可执行(x)等权限,对于一般的文件来说,权限比较容易理解:可读表示能够读取文件的实际内容,可写表示能够编辑 新增 修改 删除文件的实际内容; 可执行表示能够运行一个脚本程序,但是对于目录文件来说,理解其权限设置就不那么简单了.对于目录文件来说,可读表示能够读取目录内的文件列表;可写表示能够在目录内新增 删除 删除 重命名文件,而可执行则表示能够进入该目录</p>
<p>读写执行权限对于文件与目录可执行命令的区别</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231519544.png" alt="image-20220323151956472"></p>
<p>文件的可读 可写 可执行权限的英文名称分别为read write execute 可以简写为rwx也可以使用数字4 2 1 来表示,文件的所有者 文件所属组及其他用户权限之间无关联</p>
<p>文件权限的字符与数字表示</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231521362.png" alt="image-20220323152142290"></p>
<p>文件权限的数字表示法基于字符(rwx)的权限计算而来的,其目的是简化权限的表示方式,例如,某个文件的权限为7, 则代表可读,可写 可执行 (4 +2 +1);若权限为6,则表示可读 可写(4+2).现在有一个文件,其所有者拥有可读 可写 可执行权限,其文件所属组拥有可读 可写的权限,其他人只有可读的权限,那么这个文件的权限就是rwxrwr-r–,数字表示法即为764.不过不能将这三个数字相加,计算出17的结果,这个不是linux系统的权限数字表示法</p>
<p>这里以rw-r-x-w-为例来介绍如何将字符表示的权限转换为数字表示的权限 首先,要将各个位上的字符替换为数字</p>
<p>减号是占位符,代表这里没有权限,在数字表示法中用0表示,也就是说rw-转换后就是420,r-x转换后就是401,-w-转换后就是020,然后将这三组数字之间的每组数字相加得出652,这便是数字表示权限</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231532476.png" alt="image-20220323153250429"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231532968.png" alt="image-20220323153256927"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231533515.png" alt="image-20220323153322475"></p>
<p>这里分别包含了文件的类型 访问的权限 所属者(属主) 所属组(属组) 占用的磁盘大小 最后修改时间和文件名称等信息. 该文件类型为普通文件 所属者权限可写 可读(rw-) 所属组权限可读(r–) 其他人也只有可读权限(r–) 文件的磁盘占用大小是34298字节,最近一次修改时间是4月2日的 0:23分 文件名称为 install.log</p>
<p>排在权限前面的减号(-)是文件类型(减号表示普通文件) linux中不同文件由于作用不同,因此类型也不尽相同.常见的文件类型包括普通文件(-) 目录文件(d) 链接文件(l) 管道文件(p) 块设备文件(b) 以及字符设备文件(c)</p>
<p>普通文件的范围特别广泛,比如纯文本信息 服务配置信息 日志信息以及shell脚本等 都属于是普通文件,几乎在每个目录下都能看到 普通文件(-) 和目录文件(d) 的身影.块设备文件(b)和字符设备文件(c) 一般是指硬件设备,比如鼠标 键盘等 在&#x2F;dev&#x2F;目录中最为常见</p>
<h3 id="文件的特殊权限"><a href="#文件的特殊权限" class="headerlink" title="文件的特殊权限"></a>文件的特殊权限</h3><p>在复杂的环境中,单纯的rwx权限是无法满足我们的需求的,因此便有了SUID SGID与SBIT的特殊权限位.这是一种对文件权限进行设置的特殊功能,可以与一般的权限同时使用,以弥补一般权限不能使用</p>
<h4 id="SUID"><a href="#SUID" class="headerlink" title="SUID"></a>SUID</h4><p>SUID是一种对二进制程序进行设置的特殊权限,能够让二进制程序的执行者临时拥有所有者的权限(仅对拥有执行权限的二进制程序有效).例如所有用户都可以执行passwd命令来修改自己的用户密码,而用户密码保存在&#x2F;etc&#x2F;shadow文件中,仔细看这个文件就会发现它的默认权限是000,也就是说除了root管理员以外,所有用户都没有查看或者编辑该文件的权限.但是在使用passwd命令时如果加上SUID特殊权限,既可以让普通用户临时获得程序所有者的身份,把变更的密码信息写入到shadow文件件中.</p>
<p>查看passwd命令属性时发现所有者的权限有rwx变成了rws,其中x改变成s就意味着该文件被赋予了SUID权限,如果原先权限位置上没有可执行权限x,那么被赋予特殊权限之后将变成大写的S</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203231951191.png" alt="image-20220323195110150"></p>
<p>一定要小心这个权限,因为一点某个命令文件被设置了SUID权限,就意味着凡是执行该文件的人都临时获取到文件所有者所对应的最高权限,因此不要将SUID权限设置到vim cat rm 等命令上面</p>
<h4 id="SGID"><a href="#SGID" class="headerlink" title="SGID"></a>SGID</h4><p>SGID特殊权限有两种应用场景:当对二进制程序进行设置时,能够让执行者临时获取文件所属组的权限;当对目录进行设置时,则是让目录内新建的文件自动继承该目录原有用户组的名称</p>
<p>SGID的第一种功能就是参考SUID而设计的,不同点在于执行程序的用户获取的不再是文件所有者的临时权限,而是获取到文件所属组的权限,在早起的linux系统中,&#x2F;dev&#x2F;kmem是一个字符设备文件,用于存储内核程序要访问的数据权限为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cr--r-----   1 root system 2,  1 Feb 11 2017  kmem</span><br></pre></td></tr></table></figure>

<p>除了root管理员或属于system组的成员之外,所有用户都没有读取该文件的权限,由于在欧宁市需要查看系统的进程状态,为了能够获取进程的状态信息,可在用于查看系统进程状态的ps命令上增加SGID特殊权限位</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-r-xr-sr-x   1 bin system 59346 Feb 11 2017  ps</span><br></pre></td></tr></table></figure>

<p>这样一来由于ps命令被增加了SGID特殊权限位,所以当用户执行该命令时,也就临时获得了system用户组的权限,从而顺利的读取到了设备文件</p>
<p>每个文件都有其归属的所有者和所属组,当创建或者传送一个文件后,这个文件就会自动归属于执行这个操作的用户(即该用户时文件的所有者) 如果现在需要在一个部门内设置共享目录,让部门内的所有人员都能读取目录中的内容,那么就可以在穿件不能共享目录之后,在该目录上设置SGID特殊权限位,这样,部门内的任何人员在里面创建的任何文件都会归属该目录的所属组,而不在是自己的基本用户组.此时用到的是SGID的第二个功能,即在某个目录中创建的文件会自动继承该目录的用户组</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232039940.png" alt="image-20220323203950890"></p>
<p>在使用上述命令设置好目录的777权限之后确保普通用户可以向其中写入文件,并为该目录设置了SGID特殊权限位后,就可以切换至一个普通用户,然后尝试在该目录中创建文件,并查看新创建的文件是否会继承新创建的文件所在的目录的所属组名称</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232043188.png" alt="image-20220323204301150"></p>
<p>除了上面提到的SGID的这两个功能,在介绍 chmod 和chown</p>
<p>chmod命令用于设置文件的一般权限及特殊属性权限, change mode </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod [参数] 文件名</span><br></pre></td></tr></table></figure>

<p>这是一个与文件权限的日常设置强相关的命令 想要把一个文件的权限设置成其所有者可读可写可执行 所属组可读 可写 其他人没有任何权限,则相应的字符表示法表示rwxrw—-,其数字法表示为760</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232047154.png" alt="image-20220323204722114"></p>
<p>chmod命令用于设置文件的所有者和所属组,英文 change own </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chown 所有者:所有组 文件名</span><br></pre></td></tr></table></figure>

<p>chmod和chown命令时用于修改文件属性和权限的最常用命令,他们还有一个特别的共性,就是针对目录进行操作时需要加上大写参数-R来表示递归操作,即对目录内的所有文件进行整体操作</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232050592.png" alt="image-20220323205047552"></p>
<h4 id="SBIT"><a href="#SBIT" class="headerlink" title="SBIT"></a>SBIT</h4><p>SBIT特殊权限位可确保用户只能删除自己的文件,而不能删除其他用户的文件.当对某个目录设置了SBIT粘滞位权限后,那么该目录中的文件就只能被其所有者执行删除操作了</p>
<p>与前面的SUID与SGID权限显示方法不同,当目录被设置了SBIT特殊权限位之后,文件的其他用户权限部分的x执行权限就会被替换成t或者T 原本有x执行权限则会写成t,原本没有x执行权限就会被写成T</p>
<p>&#x2F;tmp目录上的SBIT权限默认已经存在,这体现为其他用户权限字段的权限变为rwt</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232056106.png" alt="image-20220323205626063"></p>
<p>其实文件能否被删除并不取决于自身的权限,而是看其所在的目录是否有写入权限</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232058887.png" alt="image-20220323205835849"></p>
<p>随后切换到一个普通用户身份下,尝试删除这个由其他人创建的文件,这时就会发现,即便读 写 执行权限全开,但是由于SBIT特殊权限位的缘故,依然无法删除该文件</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232100803.png" alt="image-20220323210044764"></p>
<p>若能善加使用特殊权限，就能实现很多巧妙的功能</p>
<p>  SUID、SGID、SBIT特殊权限的设置参数</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>u+s</td>
<td>设置SUID权限</td>
</tr>
<tr>
<td>u-s</td>
<td>取消SUID权限</td>
</tr>
<tr>
<td>g+s</td>
<td>设置SGID权限</td>
</tr>
<tr>
<td>g-s</td>
<td>取消SGID权限</td>
</tr>
<tr>
<td>o+t</td>
<td>设置SBIT权限</td>
</tr>
<tr>
<td>o-t</td>
<td>取消SBIT权限</td>
</tr>
</tbody></table>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232240906.png" alt="image-20220323224011863"></p>
<p>上述的代码中o+t参数是在一般权限已经设置了完毕的前提下,又新增了意向特殊权限,如果我们像将一般的权限和特殊权限一起设置,</p>
<p>其实SUID SGID SBIT也有对应的数字表示法,分别表示为4 2 1 也就是说777还不是最大的权限,最大的权限应该是7777,其中第一个数字代表的是特殊位置权限.</p>
<p>在rwxr-xr-t权限中,最后一位是t,这说明了该文件的一般权限是rwxr-xr-x,并带有SBIT特殊权限,-rwxr-xr-x即为755,而SBIT特殊权限位是1,则合并之后的结果为1755</p>
<p>如果权限是rwsrwSr–呢 大写的S表示原本没有执行全心,因此一般权限为rwxrw-r–,将其转换为数字表示法后的结果是764.带有SUID和SGID特殊权限的数字法表示是4和2,所以结果就是6,合并之后就是6764.</p>
<p>将权限的数字表示法转换成字符表示法的难度有点高,这里以5537为例.首先特殊权限5是有4+1组合成的,意味着有SUID和SBIT.SUID和SBIT的写法是,原先有执行权限则是小写s如果没有执行权限则是大写的S;而SBIT的写法则是,原先有执行权限是小写t,没有执行权限是大写的T.一般权限的537进行字符转换后应该为r-x-wxrwx,然后再此基础上增加SUID和SBIT特殊权限,合并后的结果是r-s-wxrwt</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232250971.png" alt="image-20220323225005921"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203232250984.png" alt="image-20220323225013936"></p>
<h3 id="文件的隐藏属性"><a href="#文件的隐藏属性" class="headerlink" title="文件的隐藏属性"></a>文件的隐藏属性</h3><p>隐藏权限的专用设置命令时chattr,专用查看命令是lsattr</p>
<h4 id="chattr命令"><a href="#chattr命令" class="headerlink" title="chattr命令"></a>chattr命令</h4><p>chattr命令用于设置文件的隐藏属性权限, change attributes </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chattr [参数] 文件名称</span><br></pre></td></tr></table></figure>

<p>如果想要把某个隐藏功能添加到文件上,则需要在命令后面追加”+参数”,如果想要将某个隐藏功能移除文件,则需要追加”-参数”.chattr命令中可供选择的隐藏权限参数非常丰富</p>
<p> chattr命令中的参数及其作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>无法对文件进行修改；若对目录设置了该参数，则仅能修改其中的子文件内容而不能新建或删除文件</td>
</tr>
<tr>
<td>a</td>
<td>仅允许补充（追加）内容，无法覆盖&#x2F;删除内容（Append Only）</td>
</tr>
<tr>
<td>S</td>
<td>文件内容在变更后立即同步到硬盘（sync）</td>
</tr>
<tr>
<td>s</td>
<td>彻底从硬盘中删除，不可恢复（用0填充原文件所在硬盘区域）</td>
</tr>
<tr>
<td>A</td>
<td>不再修改这个文件或目录的最后访问时间（atime）</td>
</tr>
<tr>
<td>b</td>
<td>不再修改文件或目录的存取时间</td>
</tr>
<tr>
<td>D</td>
<td>检查压缩文件中的错误</td>
</tr>
<tr>
<td>d</td>
<td>使用dump命令备份时忽略本文件&#x2F;目录</td>
</tr>
<tr>
<td>c</td>
<td>默认将文件或目录进行压缩</td>
</tr>
<tr>
<td>u</td>
<td>当删除该文件后依然保留其在硬盘中的数据，方便日后恢复</td>
</tr>
<tr>
<td>t</td>
<td>让文件系统支持尾部合并（tail-merging）</td>
</tr>
<tr>
<td>x</td>
<td>可以直接访问压缩文件中的内容</td>
</tr>
</tbody></table>
<p>先来创建一个普通文件，然后立即尝试删除</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240915136.png" alt="image-20220324091458076"></p>
<p>接下来在创建一个普通文件,将其设置”不允许删除与覆盖”(+a参数)权限,然后再尝试删除</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240917531.png" alt="image-20220324091711487"></p>
<h4 id="lsattr命令"><a href="#lsattr命令" class="headerlink" title="lsattr命令"></a>lsattr命令</h4><p>lsattr命令用于查看文件的隐藏权限 英文 list attributes 语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lsattr [参数] 文件名称</span><br></pre></td></tr></table></figure>

<p>文件的隐藏权限必须通过lsattr命令来查看</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240920320.png" alt="image-20220324092034283"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240921352.png" alt="image-20220324092116317"></p>
<p>一帮会将-a参数设置到日志文件中(&#x2F;var&#x2F;logmessages),这样可以在不影响系统正常写入日志的前提下,防止黑客擦除自己的作案证据.如果希望彻底保护某个文件,不允许其他人修改或者删除它的话,可以加上-i参数</p>
<p>要想彻底删除某个文件,可以使用-s参数来保证其被删除后不可恢复,硬盘上的文件数据会被用零块重新填充</p>
<h3 id="文件访问控制列表"><a href="#文件访问控制列表" class="headerlink" title="文件访问控制列表"></a>文件访问控制列表</h3><p>如果希望对某个指定的用户进行单独的权限控制,就需要用到文件的访问控制列表了(ACL),基于普通文件或者目录设置ACL其实就是针对特定的用户或用户组设置文件或者目录的操作权限,更加精确的派发权限.如果针对某个目录设置了ACL则目录中的文件会继承其ACL权限,若针对文件设置了ACL,则文件不在继承其所在目录的ACL权限</p>
<p>先切换到普通用户，然后尝试进入root管理员的家目录中</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240940560.png" alt="image-20220324094030519"></p>
<h4 id="setfacl命令"><a href="#setfacl命令" class="headerlink" title="setfacl命令"></a>setfacl命令</h4><p>setfacl命令用于管理文件的ACL权限规则 set files ACL</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">setfacl [参数] 文件名称</span><br></pre></td></tr></table></figure>

<p>ACL权限提供的是在所有者 所属组 其他人的读 写 执行权限之外的特殊权限控制.使用setfacl命令可以针对单一用户或用户组 单一文件或目录来进行 读 写 执行权限的控制 其中针对目录文件需要使用 -R 递归参数 针对普通文件则使用-m 参数 如果想要删除某个文件的ACL可以使用-b参数</p>
<p> setfacl命令中的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-m</td>
<td>修改权限</td>
</tr>
<tr>
<td>-M</td>
<td>从文件中读取权限</td>
</tr>
<tr>
<td>-x</td>
<td>删除某个权限</td>
</tr>
<tr>
<td>-b</td>
<td>删除全部权限</td>
</tr>
<tr>
<td>-R</td>
<td>递归子目录</td>
</tr>
</tbody></table>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240945063.png" alt="image-20220324094544019"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240945340.png" alt="image-20220324094551294"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240946640.png" alt="image-20220324094656601"></p>
<p>常用的ls命令时看不到ACL信息的,但是却可以看到文件权限最后的一个(.)变成了加号(+),这就意味着该文件已经设置了ACL </p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240948391.png" alt="image-20220324094833346"></p>
<h4 id="getfacl命令"><a href="#getfacl命令" class="headerlink" title="getfacl命令"></a>getfacl命令</h4><p>getfacl命令用于查看文件的ACL权限规则, get files ACL</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getfacl [参数] 文件名称</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240949215.png" alt="image-20220324094949167"></p>
<p>允许某个组的用户都可以读写&#x2F;etc&#x2F;fstab文件：</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240950533.png" alt="image-20220324095000483"></p>
<p>要清空所有ACL权限，请用-b参数；要删除某一条指定的权限，就用-x参数</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240950333.png" alt="image-20220324095014290"></p>
<p>ACL权限的设置都是立即且永久生效的，不需要再编辑什么配置文件</p>
<p>在备份&#x2F;home目录上的ACL权限时，可使用-R递归参数，这样不仅能够把目录本身的权限进行备份，还能将里面的文件权限也自动备份.getfacl在备份目录权限时不能使用绝对路径的形式，因此我们需要先切换到最上层根目录，然后再进行操作。</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240951347.png" alt="image-20220324095101305"></p>
<p>ACL权限的恢复也很简单，使用的是–restore参数。由于在备份时已经指定是对&#x2F;home目录进行操作，所以不需要写对应的目录名称，它能够自动找到要恢复的对象</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240951501.png" alt="image-20220324095116464"></p>
<h3 id="su命令与sudo服务"><a href="#su命令与sudo服务" class="headerlink" title="su命令与sudo服务"></a>su命令与sudo服务</h3><h4 id="su命令"><a href="#su命令" class="headerlink" title="su命令"></a>su命令</h4><p>su命令可以解决切换用户身份的需求,使得当前用户在不退出登录的情况下,顺利的切换到其他用户</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240953570.png" alt="image-20220324095334523"></p>
<p>这其中的减号(-),就意味着完全切换到新用户,即把环境变量信息也变更为新用户的响应信息,而不是保留原始信息</p>
<p>从root管理员切换到普通用户时是不需要验证密码的,而从普通用户切换成root用户就需要进行密码验证了</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203240956232.png" alt="image-20220324095601190"></p>
<p>虽然这样使用su命令,普通用户可以完全切换到root管理员用户的身份来进行工作但是这将暴露root管理员的密码</p>
<h4 id="sudo命令"><a href="#sudo命令" class="headerlink" title="sudo命令"></a>sudo命令</h4><p>sudo命令用于给普通鱼护提供额外的权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo [参数] 用户名</span><br></pre></td></tr></table></figure>

<p>使用sudo命令可以给普通用户提供额外的权限来完成只有root用户才能完成的任务,可限制用户执行指定的命令,记录用户执行过的每一条命令,集中管理用户与全心(&#x2F;etc&#x2F;sudoers),以及可以在验证密码后的一段时间内无需让用户再次验证密码</p>
<p>  sudo命令中的可用参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-h</td>
<td>列出帮助信息</td>
</tr>
<tr>
<td>-l</td>
<td>列出当前用户可执行的命令</td>
</tr>
<tr>
<td>-u 用户名或UID值</td>
<td>以指定的用户身份执行命令</td>
</tr>
<tr>
<td>-k</td>
<td>清空密码的有效时间，下次执行sudo时需要再次进行密码验证</td>
</tr>
<tr>
<td>-b</td>
<td>在后台执行指定的命令</td>
</tr>
<tr>
<td>-p</td>
<td>更改询问密码的提示语</td>
</tr>
</tbody></table>
<h4 id="visudo命令"><a href="#visudo命令" class="headerlink" title="visudo命令"></a>visudo命令</h4><p>visudo命令用于编辑 配置用户sudo的权限文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">visudo [参数]</span><br></pre></td></tr></table></figure>

<p>这是一条会自动调用vi编辑器来配置&#x2F;etc&#x2F;sudoers权限文件的命令.能够解决多个用户同时自改权限而导致的冲突问题.visudo命令还可以对配置文件内的参数进行语法检查,并在发现参数错误时进行报错提醒.</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241004757.png" alt="image-20220324100435706"></p>
<p>使用visudo命令配置权限文件的时候.其操作方法和vim编辑器中用到的方法完全一致因此在编写完成后记得在末行模式下保存并退出。在配置权限文件时，按照下面的格式在第101行（大约）填写上指定的信息</p>
<pre><code>谁可以使用 允许使用的主机 = （以谁的身份） 可执行命令的列表

谁可以使用：稍后要为哪位用户进行命令授权。

允许使用的主机：可以填写ALL表示不限制来源的主机，亦可填写如192.168.10.0/24这样的网段限制来源地址，使得只有从允许网段登录时才能使用sudo命令。

以谁的身份：可以填写ALL表示系统最高权限，也可以是另外一位用户的名字。

可执行命令的列表：可以填写ALL表示不限制命令，亦可填写如/usr/bin/cat这样的文件名称来限制命令列表，多个命令文件之间用逗号（,）间隔。
</code></pre>
<p>在Linux系统中配置服务文件时，虽然没有硬性规定，但从经验来讲新增参数的位置不建议太靠上，以免我们新填写的参数在执行时失败，导致一些必要的服务功能没有成功加载。一般建议在配置文件中找一下相似的参数，然后在相邻位置进行新的修改，或者在文件的中下部位置进行添加后修改</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241006086.png" alt="image-20220324100615041"></p>
<p>在填写完毕后记得要先保存再退出，然后切换至指定的普通用户身份，此时就可以用sudo -l命令查看所有可执行的命令了（在下面的命令中，验证的是普通用户的密码，而不是root管理员的密码)</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241006032.png" alt="image-20220324100630970"></p>
<p>作为一名普通用户，是肯定不能看到root管理员的家目录（&#x2F;root）中的文件信息的，但是，只需要在想执行的命令前面加上sudo命令就行了</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241007640.png" alt="image-20220324100708591"></p>
<p>每次执行sudo命令后都会要求验证一下密码。虽然这个密码就是当前登录用户的密码，但是每次执行sudo命令都要输入一次密码其实也挺麻烦的，这时可以添加NOPASSWD参数，使得用户下次再执行sudo命令时就不用密码验证</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241007780.png" alt="image-20220324100756732"></p>
<p>这样，当切换到普通用户后再执行命令时，就不用再频繁地验证密码了</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203241008670.png" alt="image-20220324100808623"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.pixabay.com/photo/2016/10/22/17/46/mountains-1761292_1280.jpg" data-sites="qq,wechat,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-22-45.png" target="_blank"><img class="post-qr-code-img" src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-22-45.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-32-45.png" target="_blank"><img class="post-qr-code-img" src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-32-45.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/"><img class="prev-cover" src="https://cdn.pixabay.com/photo/2016/11/25/23/15/moon-1859616_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux学习(二)</div></div></a></div><div class="next-post pull-right"><a href="/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E4%BA%94)/"><img class="next-cover" src="https://cdn.pixabay.com/photo/2015/10/30/20/13/sea-1014710_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux学习(五)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/" title="Linux学习(二)"><img class="cover" src="https://cdn.pixabay.com/photo/2016/11/25/23/15/moon-1859616_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-24</div><div class="title">Linux学习(二)</div></div></a></div><div><a href="/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E4%B8%80)/" title="Linux学习(一)"><img class="cover" src="https://cdn.pixabay.com/photo/2016/11/06/05/36/lake-1802337_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-22</div><div class="title">Linux学习(一)</div></div></a></div><div><a href="/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E4%BA%94)/" title="Linux学习(五)"><img class="cover" src="https://cdn.pixabay.com/photo/2015/10/30/20/13/sea-1014710_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-24</div><div class="title">Linux学习(五)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux%E5%AD%A6%E4%B9%A0-%E5%9B%9B"><span class="toc-number">1.</span> <span class="toc-text">Linux学习(四)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E4%B8%8E%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="toc-number">1.1.</span> <span class="toc-text">用户身份与文件权限</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E4%B8%8E%E8%83%BD%E5%8A%9B"><span class="toc-number">1.1.1.</span> <span class="toc-text">用户身份与能力</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#id%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">id命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#useradd%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">useradd命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groupadd%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">groupadd命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#usermod%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">usermod命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#passwd%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">passwd命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#userdel%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.6.</span> <span class="toc-text">userdel命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%B8%8E%E5%BD%92%E5%B1%9E"><span class="toc-number">1.1.2.</span> <span class="toc-text">文件权限与归属</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90"><span class="toc-number">1.1.3.</span> <span class="toc-text">文件的特殊权限</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SUID"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">SUID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SGID"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">SGID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SBIT"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">SBIT</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E9%9A%90%E8%97%8F%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.4.</span> <span class="toc-text">文件的隐藏属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#chattr%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">chattr命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lsattr%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">lsattr命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8"><span class="toc-number">1.1.5.</span> <span class="toc-text">文件访问控制列表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#setfacl%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">setfacl命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getfacl%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">getfacl命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#su%E5%91%BD%E4%BB%A4%E4%B8%8Esudo%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.1.6.</span> <span class="toc-text">su命令与sudo服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#su%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">su命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sudo%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">sudo命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#visudo%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">visudo命令</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By wanan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'RjFSSKpeg1lxuvDjmLndzaLO-MdYXbMMI',
      appKey: '8qrAyIwMaJTebKjjzPnV0SFT',
      avatar: 'monsterid',
      serverURLs: 'https://valine.wanan.red',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://www.wanan.red/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/'
    this.page.identifier = '/Linux/Linux-linux%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/'
    this.page.title = 'Linux学习(四)'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://www-wanan-red.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }

  document.getElementById('darkmode').addEventListener('click', () => {
    setTimeout(() => window.disqusReset(), 200)
  })
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>(function(d, w, c) {
    w.ChatraID = 'LAbfxFAsFCbvYgjHY';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>